C**   The name of this program is 7segsprint_raw.f
C**   Created by AUTOLEV 3.2 on Mon Jun 28 18:20:35 2021

      IMPLICIT         DOUBLE PRECISION (A - Z)
      INTEGER          ILOOP, IPRINT, PRINTINT
      CHARACTER        MESSAGE(99)
      EXTERNAL         EQNS1
      DIMENSION        VAR(14)
      COMMON/CONSTNTS/ FOOTANG,G,IA,IB,IC,ID,IE,IF,IG,K1,K2,K3,K4,K5,K6,
     &K7,K8,L1,L10,L11,L12,L2,L3,L4,L5,L6,L7,L8,L9,MA,MB,MC,MD,ME,MF,MG,
     &MTPB,MTPK
      COMMON/VARIBLES/ Q1,Q2,Q3,Q4,Q5,Q6,Q7,U1,U2,U3,U4,U5,U6,U7
      COMMON/ALGBRAIC/ AANG,AANGVEL,AETOR,AFTOR,ATOR,COP,GRF,HANG,HANGVE
     &L,HETOR,HFTOR,HTOR,HZ,KANG,KANGVEL,KECM,KETOR,KFTOR,KTOR,MANG,MANG
     &VEL,METOR,MFTOR,MTOR,PECM,PX,PY,RX,RX1,RX2,RY,RY1,RY2,SHANG,SHANGV
     &EL,SHTOR,SKANG,SKANGVEL,SKTOR,TE,U8,U9,Q1p,Q2p,Q3p,Q4p,Q5p,Q6p,Q7p
     &,U1p,U2p,U3p,U4p,U5p,U6p,U7p,AEACT,AECCANG,AECCANGVEL,AESECANG,AES
     &ECANGVEL,AFACT,AFCCANG,AFCCANGVEL,AFSECANG,AFSECANGVEL,EA,FA,GS,HE
     &ACT,HECCANG,HECCANGVEL,HESECANG,HESECANGVEL,HFACT,HFCCANG,HFCCANGV
     &EL,HFSECANG,HFSECANGVEL,KEACT,KECCANG,KECCANGVEL,KESECANG,KESECANG
     &VEL,KFACT,KFCCANG,KFCCANGVEL,KFSECANG,KFSECANGVEL,MEACT,MECCANG,ME
     &CCANGVEL,MESECANG,MESECANGVEL,MFACT,MFCCANG,MFCCANGVEL,MFSECANG,MF
     &SECANGVEL,EAp,FAp,GSp,EApp,FApp,GSpp,MT,POCMSTANCEX,POCMSTANCEY,PO
     &CMSWINGX,POCMSWINGY,POCMX,POCMY,POGOX,POGOY,POP1X,POP1Y,POP2X,POP2
     &Y,POP3X,POP3Y,POP4X,POP4Y,POP5X,POP5Y,POP6X,POP6Y,POP7X,POP7Y,POP8
     &X,POP8Y,POP9X,POP9Y,PSTANCEX,PSTANCEY,PSWINGX,PSWINGY,VOCMSTANCEX,
     &VOCMSTANCEY,VOCMSWINGX,VOCMSWINGY,VOCMX,VOCMY,VOP2X,VOP2Y
      COMMON/MISCLLNS/ PI,DEGtoRAD,RADtoDEG,COEF(7,7),RHS(7)

C**   Open input and output files
      OPEN(UNIT=20, FILE='7segsprint_raw.in', STATUS='OLD')
      OPEN(UNIT=21, FILE='7segsprint_raw.1',  STATUS='UNKNOWN')
      OPEN(UNIT=22, FILE='7segsprint_raw.2',  STATUS='UNKNOWN')
      OPEN(UNIT=23, FILE='7segsprint_raw.3',  STATUS='UNKNOWN')
      OPEN(UNIT=24, FILE='7segsprint_raw.4',  STATUS='UNKNOWN')
      OPEN(UNIT=25, FILE='7segsprint_raw.5',  STATUS='UNKNOWN')
      OPEN(UNIT=26, FILE='7segsprint_raw.6',  STATUS='UNKNOWN')
      OPEN(UNIT=27, FILE='7segsprint_raw.7',  STATUS='UNKNOWN')
      OPEN(UNIT=28, FILE='7segsprint_raw.8',  STATUS='UNKNOWN')
      OPEN(UNIT=29, FILE='7segsprint_raw.9',  STATUS='UNKNOWN')
      OPEN(UNIT=30, FILE='7segsprint_raw.10',  STATUS='UNKNOWN')
      OPEN(UNIT=31, FILE='7segsprint_raw.11',  STATUS='UNKNOWN')

C**   Read message from input file
      READ(20,7000,END=7100,ERR=7101) (MESSAGE(ILOOP),ILOOP = 1,99)

C**   Read values of constants from input file
      READ(20,7010,END=7100,ERR=7101) FOOTANG,G,IA,IB,IC,ID,IE,IF,IG,K1,
     &K2,K3,K4,K5,K6,K7,K8,L1,L10,L11,L12,L2,L3,L4,L5,L6,L7,L8,L9,MA,MB,
     &MC,MD,ME,MF,MG,MTPB,MTPK

C**   Read the initial value of each variable from input file
      READ(20,7010,END=7100,ERR=7101) Q1,Q2,Q3,Q4,Q5,Q6,Q7,U1,U2,U3,U4,U
     &5,U6,U7

C**   Read integration parameters from input file
      READ(20,7011,END=7100,ERR=7101) TINITIAL,TFINAL,INTEGSTP,PRINTINT,
     &ABSERR,RELERR

C**   Write heading(s) to output file(s)
      WRITE(*, 6021) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(21,6021) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(22,6022) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(23,6023) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(24,6024) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(25,6025) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(26,6026) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(27,6027) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(28,6028) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(29,6029) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(30,6030) (MESSAGE(ILOOP), ILOOP = 1,99) 
      WRITE(31,6031) (MESSAGE(ILOOP), ILOOP = 1,99) 

C**   Degree to radian conversion
      PI       = 4*ATAN(1.0D0)
      DEGtoRAD = PI/180.0D0
      RADtoDEG = 180.0D0/PI
      FOOTANG = FOOTANG*DEGtoRAD
      Q3 = Q3*DEGtoRAD
      Q4 = Q4*DEGtoRAD
      Q5 = Q5*DEGtoRAD
      Q6 = Q6*DEGtoRAD
      Q7 = Q7*DEGtoRAD

C**   Evaluate constants
      MT = MA + MB + MC + MD + ME + MF + MG
      U8 = 0
      U9 = 0

C**   Initialize time, print counter, variables array for integrator
      T      = TINITIAL
      IPRINT = 0
      VAR(1) = Q1
      VAR(2) = Q2
      VAR(3) = Q3
      VAR(4) = Q4
      VAR(5) = Q5
      VAR(6) = Q6
      VAR(7) = Q7
      VAR(8) = U1
      VAR(9) = U2
      VAR(10) = U3
      VAR(11) = U4
      VAR(12) = U5
      VAR(13) = U6
      VAR(14) = U7

C**   Initalize numerical integrator with call to EQNS1 at T=TINITIAL
      CALL KUTTA(EQNS1, 14, VAR, T, INTEGSTP, ABSERR, RELERR, 0, *5920)

C**   Numerically integrate; print results
5900  IF( TFINAL.GE.TINITIAL .AND. T+.01D0*INTEGSTP.GE.TFINAL) IPRINT=-7
      IF( TFINAL.LE.TINITIAL .AND. T+.01D0*INTEGSTP.LE.TFINAL) IPRINT=-7
      IF( IPRINT .LE. 0 ) THEN
        CALL IO(T)
        IF( IPRINT .EQ. -7 ) GOTO 5930
        IPRINT = PRINTINT
      ENDIF
      CALL KUTTA(EQNS1, 14, VAR, T, INTEGSTP, ABSERR, RELERR, 1, *5920)
      IPRINT = IPRINT - 1
      GOTO 5900

C**   Print message if numerical integration fails to converge
5920  CALL IO(T)
      WRITE(*, 6997)
      WRITE(21,6997)
      WRITE(22,6997)
      WRITE(23,6997)
      WRITE(24,6997)
      WRITE(25,6997)
      WRITE(26,6997)
      WRITE(27,6997)
      WRITE(28,6997)
      WRITE(29,6997)
      WRITE(30,6997)
      WRITE(31,6997)

C**   Inform user of input and output filename(s)
5930  WRITE(*,6999)

6021  FORMAT(1X,'FILE: 7segsprint_raw.1 ',//1X,'*** ',99A1,///,8X,'T',12
     &X,'POP1X',10X,'POP1Y',10X,'POP2X',10X,'POP2Y',10X,'POP3X',10X,'POP
     &3Y',10X,'POP4X',10X,'POP4Y',10X,'POP5X',10X,'POP5Y',10X,'POP6X',10
     &X,'POP6Y',10X,'POP7X',10X,'POP7Y',10X,'POP8X',10X,'POP8Y',10X,'POP
     &9X',10X,'POP9Y',10X,'POGOX',10X,'POGOY',7X,'POCMSTANCEX',4X,'POCMS
     &TANCEY',4X,'POCMSWINGX',5X,'POCMSWINGY',8X,'POCMX',10X,'POCMY',10X
     &,'VOCMX',10X,'VOCMY',8X,'PSTANCEX',7X,'PSTANCEY',8X,'PSWINGX',8X,'
     &PSWINGY',6X,'VOCMSTANCEX',4X,'VOCMSTANCEY',4X,'VOCMSWINGX',5X,'VOC
     &MSWINGY',/,7X,'(S)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(
     &M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12
     &X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)
     &',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,'(M)',12X,
     &'(M)',12X,'(M)',11X,'(M/S)',10X,'(M/S)',9X,'(UNITS)',8X,'(UNITS)',
     &8X,'(UNITS)',8X,'(UNITS)',9X,'(M/S)',10X,'(M/S)',10X,'(M/S)',10X,'
     &(M/S)',/)
6022  FORMAT(1X,'FILE: 7segsprint_raw.2 ',//1X,'*** ',99A1,///,8X,'T',13
     &X,'Q1',13X,'Q2',13X,'Q3',13X,'Q4',13X,'Q5',13X,'Q6',13X,'Q7',13X,'
     &U1',13X,'U2',13X,'U3',13X,'U4',13X,'U5',13X,'U6',13X,'U7',/,7X,'(S
     &)',12X,'(M)',12X,'(M)',11X,'(DEG)',10X,'(DEG)',10X,'(DEG)',10X,'(D
     &EG)',10X,'(DEG)',10X,'(M/S)',10X,'(M/S)',9X,'(DEG/S)',8X,'(DEG/S)'
     &,8X,'(DEG/S)',8X,'(DEG/S)',8X,'(DEG/S)',/)
6023  FORMAT(1X,'FILE: 7segsprint_raw.3 ',//1X,'*** ',99A1,///,8X,'T',13
     &X,'RX',13X,'RY',12X,'HTOR',11X,'KTOR',11X,'ATOR',11X,'MTOR',11X,'S
     &HTOR',10X,'SKTOR',/,7X,'(S)',12X,'(N)',12X,'(N)',11X,'(N/M)',10X,'
     &(N/M)',10X,'(N/M)',10X,'(N/M)',10X,'(N/M)',10X,'(N/M)',/)
6024  FORMAT(1X,'FILE: 7segsprint_raw.4 ',//1X,'*** ',99A1,///,8X,'T',13
     &X,'Q3',12X,'HANG',11X,'KANG',11X,'AANG',11X,'MANG',11X,'SHANG',10X
     &,'SKANG',11X,'U3',11X,'HANGVEL',8X,'KANGVEL',8X,'AANGVEL',8X,'MANG
     &VEL',7X,'SHANGVEL',7X,'SKANGVEL',/,7X,'(S)',11X,'(DEG)',10X,'(DEG)
     &',10X,'(DEG)',10X,'(DEG)',10X,'(DEG)',10X,'(DEG)',10X,'(DEG)',9X,'
     &(DEG/S)',8X,'(DEG/S)',8X,'(DEG/S)',8X,'(DEG/S)',8X,'(DEG/S)',8X,'(
     &DEG/S)',8X,'(DEG/S)',/)
6025  FORMAT(1X,'FILE: 7segsprint_raw.5 ',//1X,'*** ',99A1,///,8X,'T',12
     &X,'KECM',11X,'PECM',12X,'TE',13X,'HZ',13X,'PX',13X,'PY',/,7X,'(S)'
     &,12X,'(J)',12X,'(J)',12X,'(J)',8X,'(KG.M^2/S)',6X,'(KG.M/S)',7X,'(
     &KG.M/S)',/)
6026  FORMAT(1X,'FILE: 7segsprint_raw.6 ',//1X,'*** ',99A1,///,8X,'T',12
     &X,'HEACT',10X,'HFACT',10X,'KEACT',10X,'KFACT',10X,'AEACT',10X,'AFA
     &CT',10X,'MEACT',10X,'MFACT',/,7X,'(S)',10X,'(UNITS)',8X,'(UNITS)',
     &8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8X,'(UNITS)',8
     &X,'(UNITS)',/)
6027  FORMAT(1X,'FILE: 7segsprint_raw.7 ',//1X,'*** ',99A1,///,8X,'T',12
     &X,'HETOR',10X,'HEACT',9X,'HECCANG',6X,'HECCANGVEL',6X,'HESECANG',6
     &X,'HESECANGVEL',7X,'HFTOR',10X,'HFACT',9X,'HFCCANG',6X,'HFCCANGVEL
     &',6X,'HFSECANG',6X,'HFSECANGVEL',/,7X,'(S)',11X,'(N/M)',9X,'(UNITS
     &)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',9X,'(N/M)',9X,'
     &(UNITS)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',/)
6028  FORMAT(1X,'FILE: 7segsprint_raw.8 ',//1X,'*** ',99A1,///,8X,'T',12
     &X,'KETOR',10X,'KEACT',9X,'KECCANG',6X,'KECCANGVEL',6X,'KESECANG',6
     &X,'KESECANGVEL',7X,'KFTOR',10X,'KFACT',9X,'KFCCANG',6X,'KFCCANGVEL
     &',6X,'KFSECANG',6X,'KFSECANGVEL',/,7X,'(S)',11X,'(N/M)',9X,'(UNITS
     &)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',9X,'(N/M)',9X,'
     &(UNITS)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',/)
6029  FORMAT(1X,'FILE: 7segsprint_raw.9 ',//1X,'*** ',99A1,///,8X,'T',12
     &X,'AETOR',10X,'AEACT',9X,'AECCANG',6X,'AECCANGVEL',6X,'AESECANG',6
     &X,'AESECANGVEL',7X,'AFTOR',10X,'AFACT',9X,'AFCCANG',6X,'AFCCANGVEL
     &',6X,'AFSECANG',6X,'AFSECANGVEL',/,7X,'(S)',11X,'(N/M)',9X,'(UNITS
     &)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',9X,'(N/M)',9X,'
     &(UNITS)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',/)
6030  FORMAT(1X,'FILE: 7segsprint_raw.10',//1X,'*** ',99A1,///,8X,'T',12
     &X,'METOR',10X,'MEACT',9X,'MECCANG',6X,'MECCANGVEL',6X,'MESECANG',6
     &X,'MESECANGVEL',7X,'MFTOR',10X,'MFACT',9X,'MFCCANG',6X,'MFCCANGVEL
     &',6X,'MFSECANG',6X,'MFSECANGVEL',/,7X,'(S)',11X,'(N/M)',9X,'(UNITS
     &)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',9X,'(N/M)',9X,'
     &(UNITS)',9X,'(DEG)',9X,'(DEG/S)',9X,'(DEG)',9X,'(DEG/S)',/)
6031  FORMAT(1X,'FILE: 7segsprint_raw.11',//1X,'*** ',99A1,///,8X,'T',13
     &X,'RX1',12X,'RY1',12X,'RX2',12X,'RY2',12X,'RX',13X,'RY',13X,'GRF',
     &12X,'COP',/,7X,'(S)',12X,'(N)',12X,'(N)',12X,'(N)',12X,'(N)',12X,'
     &(N)',12X,'(N)',12X,'(N)',12X,'(M)',/)
6997  FORMAT(/7X,'Error: Numerical integration failed to converge',/)
6999  FORMAT(//1X,'Input is in the file 7segsprint_raw.in',//1X,'Output 
     &is in the file(s) 7segsprint_raw.i  (i=1, ..., 11)',//1X,'The outp
     &ut quantities and associated files are listed in file 7segsprint_r
     &aw.dir',/)
7000  FORMAT(//,99A1,///)
7010  FORMAT( 1000(59X,E30.0,/) )
7011  FORMAT( 3(59X,E30.0,/), 1(59X,I30,/), 2(59X,E30.0,/) )
      STOP
7100  WRITE(*,*) 'Premature end of file while reading 7segsprint_raw.in 
     &'
7101  WRITE(*,*) 'Error while reading file 7segsprint_raw.in'
      STOP
      END


C**********************************************************************
      SUBROUTINE       EQNS1(T, VAR, VARp, BOUNDARY)
      IMPLICIT         DOUBLE PRECISION (A - Z)
      INTEGER          BOUNDARY
      DIMENSION        VAR(*), VARp(*)
      COMMON/CONSTNTS/ FOOTANG,G,IA,IB,IC,ID,IE,IF,IG,K1,K2,K3,K4,K5,K6,
     &K7,K8,L1,L10,L11,L12,L2,L3,L4,L5,L6,L7,L8,L9,MA,MB,MC,MD,ME,MF,MG,
     &MTPB,MTPK
      COMMON/VARIBLES/ Q1,Q2,Q3,Q4,Q5,Q6,Q7,U1,U2,U3,U4,U5,U6,U7
      COMMON/ALGBRAIC/ AANG,AANGVEL,AETOR,AFTOR,ATOR,COP,GRF,HANG,HANGVE
     &L,HETOR,HFTOR,HTOR,HZ,KANG,KANGVEL,KECM,KETOR,KFTOR,KTOR,MANG,MANG
     &VEL,METOR,MFTOR,MTOR,PECM,PX,PY,RX,RX1,RX2,RY,RY1,RY2,SHANG,SHANGV
     &EL,SHTOR,SKANG,SKANGVEL,SKTOR,TE,U8,U9,Q1p,Q2p,Q3p,Q4p,Q5p,Q6p,Q7p
     &,U1p,U2p,U3p,U4p,U5p,U6p,U7p,AEACT,AECCANG,AECCANGVEL,AESECANG,AES
     &ECANGVEL,AFACT,AFCCANG,AFCCANGVEL,AFSECANG,AFSECANGVEL,EA,FA,GS,HE
     &ACT,HECCANG,HECCANGVEL,HESECANG,HESECANGVEL,HFACT,HFCCANG,HFCCANGV
     &EL,HFSECANG,HFSECANGVEL,KEACT,KECCANG,KECCANGVEL,KESECANG,KESECANG
     &VEL,KFACT,KFCCANG,KFCCANGVEL,KFSECANG,KFSECANGVEL,MEACT,MECCANG,ME
     &CCANGVEL,MESECANG,MESECANGVEL,MFACT,MFCCANG,MFCCANGVEL,MFSECANG,MF
     &SECANGVEL,EAp,FAp,GSp,EApp,FApp,GSpp,MT,POCMSTANCEX,POCMSTANCEY,PO
     &CMSWINGX,POCMSWINGY,POCMX,POCMY,POGOX,POGOY,POP1X,POP1Y,POP2X,POP2
     &Y,POP3X,POP3Y,POP4X,POP4Y,POP5X,POP5Y,POP6X,POP6Y,POP7X,POP7Y,POP8
     &X,POP8Y,POP9X,POP9Y,PSTANCEX,PSTANCEY,PSWINGX,PSWINGY,VOCMSTANCEX,
     &VOCMSTANCEY,VOCMSWINGX,VOCMSWINGY,VOCMX,VOCMY,VOP2X,VOP2Y
      COMMON/MISCLLNS/ PI,DEGtoRAD,RADtoDEG,COEF(7,7),RHS(7)

C**   Update variables after integration step
      Q1 = VAR(1)
      Q2 = VAR(2)
      Q3 = VAR(3)
      Q4 = VAR(4)
      Q5 = VAR(5)
      Q6 = VAR(6)
      Q7 = VAR(7)
      U1 = VAR(8)
      U2 = VAR(9)
      U3 = VAR(10)
      U4 = VAR(11)
      U5 = VAR(12)
      U6 = VAR(13)
      U7 = VAR(14)

      Q1p = U1
      Q2p = U2
      Q3p = U3
      Q4p = U4
      Q5p = U5
      Q6p = U6
      Q7p = U7
      RY1 = -K3*Q2 - K4*ABS(Q2)*U2
      RX1 = -RY1*(K1*Q1+K2*U1)
      POP2Y = Q2 - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      VOP2Y = U2 - L2*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)
      RY2 = -K7*POP2Y - K8*ABS(POP2Y)*VOP2Y
      POP2X = Q1 - L2*COS(Q3-Q4-Q5-Q6-Q7)
      VOP2X = U1 + L2*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)
      RX2 = -RY2*(K5*POP2X+K6*VOP2X)
      MANG = Q4
      MANGVEL = U4
      MTOR = MTPK*(3.141592653589793D0-MANG) - MTPB*MANGVEL

C**   Quantities which were specified
      EA = T**3
      EAp = T**3
      EApp = T**3
      FA = T**3
      FAp = T**3
      FApp = T**3
      GS = T**3
      GSp = T**3
      GSpp = T**3
      HEACT = T
      HFACT = T
      KEACT = T
      KFACT = T
      AEACT = T
      AFACT = T
      MEACT = T
      MFACT = T
      HECCANG = T
      HECCANGVEL = T
      HESECANG = T
      HESECANGVEL = T
      HFCCANG = T
      HFCCANGVEL = T
      HFSECANG = T
      HFSECANGVEL = T
      KECCANG = T
      KECCANGVEL = T
      KESECANG = T
      KESECANGVEL = T
      KFCCANG = T
      KFCCANGVEL = T
      KFSECANG = T
      KFSECANGVEL = T
      AECCANG = T
      AECCANGVEL = T
      AESECANG = T
      AESECANGVEL = T
      AFCCANG = T
      AFCCANGVEL = T
      AFSECANG = T
      AFSECANGVEL = T
      MECCANG = T
      MECCANGVEL = T
      MESECANG = T
      MESECANGVEL = T
      MFCCANG = T
      MFCCANGVEL = T
      MFSECANG = T
      MFSECANGVEL = T

      HETOR = T*HEACT*HECCANG*HECCANGVEL*HESECANG*HESECANGVEL
      HFTOR = T*HFACT*HFCCANG*HFCCANGVEL*HFSECANG*HFSECANGVEL
      KETOR = T*KEACT*KECCANG*KECCANGVEL*KESECANG*KESECANGVEL
      KFTOR = T*KFACT*KFCCANG*KFCCANGVEL*KFSECANG*KFSECANGVEL
      AETOR = T*AEACT*AECCANG*AECCANGVEL*AESECANG*AESECANGVEL
      AFTOR = T*AFACT*AFCCANG*AFCCANGVEL*AFSECANG*AFSECANGVEL
      HTOR = HETOR - HFTOR
      KTOR = KETOR - KFTOR
      ATOR = AETOR - AFTOR

      COEF(1,1) = -MA - MB - MC - MD - ME - MF - MG
      COEF(1,2) = 0
      COEF(1,3) = MC*(L7*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-
     &Q5-Q6-Q7)) + 0.5D0*MB*(L4*SIN(Q3-Q5-Q6-Q7)+L3*SIN(FOOTANG+Q3-Q5-Q6
     &-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7)) + MD*(L9*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7
     &)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) + MG*(GS*SIN(Q3)+L10
     &*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q
     &6-Q7)) + ME*(L10*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-(
     &L10-L9)*SIN(EA-Q3)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) + MF*(L10*SIN(Q3-Q7)+L1
     &2*SIN(EA-FA-Q3)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L10*SIN(EA-Q3
     &)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - L1*MA*SIN(Q3-Q4-Q5-Q6-Q7)
      COEF(1,4) = (L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)*SIN(Q3-Q4-
     &Q5-Q6-Q7)
      COEF(1,5) = L1*MA*SIN(Q3-Q4-Q5-Q6-Q7) - MC*(L6*SIN(Q3-Q5-Q6-Q7)-L2
     &*SIN(Q3-Q4-Q5-Q6-Q7)) - MD*(L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6
     &-Q7)) - ME*(L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MF*(L6*S
     &IN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MG*(L6*SIN(Q3-Q5-Q6-Q7)-
     &L2*SIN(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*SIN(Q3-Q5-Q6-Q7)+L3*SIN(FOO
     &TANG+Q3-Q5-Q6-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7))
      COEF(1,6) = L1*MA*SIN(Q3-Q4-Q5-Q6-Q7) - MC*(L7*SIN(Q3-Q6-Q7)+L6*SI
     &N(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MD*(L8*SIN(Q3-Q6-Q7)+L6*S
     &IN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - ME*(L8*SIN(Q3-Q6-Q7)+L6*
     &SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MF*(L8*SIN(Q3-Q6-Q7)+L6
     &*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MG*(L8*SIN(Q3-Q6-Q7)+L
     &6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*SIN(Q3-Q
     &5-Q6-Q7)+L3*SIN(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7))
      COEF(1,7) = L1*MA*SIN(Q3-Q4-Q5-Q6-Q7) - MC*(L7*SIN(Q3-Q6-Q7)+L6*SI
     &N(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*SIN(Q3-Q5-Q6
     &-Q7)+L3*SIN(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MD*(L
     &9*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-
     &Q6-Q7)) - ME*(L10*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-
     &L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MF*(L10*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*S
     &IN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MG*(L10*SIN(Q3-Q7)+L8*SI
     &N(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7))
      COEF(2,1) = 0
      COEF(2,2) = -MA - MB - MC - MD - ME - MF - MG
      COEF(2,3) = L1*MA*COS(Q3-Q4-Q5-Q6-Q7) - MC*(L7*COS(Q3-Q6-Q7)+L6*CO
     &S(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*COS(Q3-Q5-Q6
     &-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)) - MD*(L
     &9*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-
     &Q6-Q7)) - MG*(GS*COS(Q3)+L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3
     &-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - ME*(L10*COS(Q3-Q7)+L8*COS(Q3-
     &Q6-Q7)+(L10-L9)*COS(EA-Q3)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-
     &Q7)) - MF*(L10*COS(EA-Q3)+L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q
     &3-Q5-Q6-Q7)-L12*COS(EA-FA-Q3)-L2*COS(Q3-Q4-Q5-Q6-Q7))
      COEF(2,4) = -(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)*COS(Q3-Q4
     &-Q5-Q6-Q7)
      COEF(2,5) = MC*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + MD*(
     &L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + ME*(L6*COS(Q3-Q5-Q6-
     &Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + MF*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4
     &-Q5-Q6-Q7)) + MG*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + 0.
     &5D0*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*COS(Q
     &3-Q4-Q5-Q6-Q7)) - L1*MA*COS(Q3-Q4-Q5-Q6-Q7)
      COEF(2,6) = MC*(L7*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-
     &Q5-Q6-Q7)) + MD*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4
     &-Q5-Q6-Q7)) + ME*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q
     &4-Q5-Q6-Q7)) + MF*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-
     &Q4-Q5-Q6-Q7)) + MG*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3
     &-Q4-Q5-Q6-Q7)) + 0.5D0*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q
     &5-Q6-Q7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)) - L1*MA*COS(Q3-Q4-Q5-Q6-Q7)
      COEF(2,7) = MC*(L7*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-
     &Q5-Q6-Q7)) + 0.5D0*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6
     &-Q7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)) + MD*(L9*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7
     &)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + ME*(L10*COS(Q3-Q7)
     &+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + MF
     &*(L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4
     &-Q5-Q6-Q7)) + MG*(L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-
     &Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - L1*MA*COS(Q3-Q4-Q5-Q6-Q7)
      COEF(3,1) = MC*(L7*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-
     &Q5-Q6-Q7)) + 0.5D0*MB*(L4*SIN(Q3-Q5-Q6-Q7)+L3*SIN(FOOTANG+Q3-Q5-Q6
     &-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7)) + MD*(L9*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7
     &)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) + MG*(GS*SIN(Q3)+L10
     &*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q
     &6-Q7)) + ME*(L10*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-(
     &L10-L9)*SIN(EA-Q3)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) + MF*(L10*SIN(Q3-Q7)+L1
     &2*SIN(EA-FA-Q3)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L10*SIN(EA-Q3
     &)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - L1*MA*SIN(Q3-Q4-Q5-Q6-Q7)
      COEF(3,2) = L1*MA*COS(Q3-Q4-Q5-Q6-Q7) - MC*(L7*COS(Q3-Q6-Q7)+L6*CO
     &S(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*COS(Q3-Q5-Q6
     &-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)) - MD*(L
     &9*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-
     &Q6-Q7)) - MG*(GS*COS(Q3)+L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3
     &-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - ME*(L10*COS(Q3-Q7)+L8*COS(Q3-
     &Q6-Q7)+(L10-L9)*COS(EA-Q3)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-
     &Q7)) - MF*(L10*COS(EA-Q3)+L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q
     &3-Q5-Q6-Q7)-L12*COS(EA-FA-Q3)-L2*COS(Q3-Q4-Q5-Q6-Q7))
      COEF(3,3) = MF*(2*L10*L12*COS(FA)+2*L2*L6*COS(Q4)+2*L2*L8*COS(Q4+Q
     &5)+2*L10*L2*COS(Q4+Q5+Q6)+2*L10*L12*COS(EA-FA-Q7)+2*L12*L8*COS(EA-
     &FA-Q6-Q7)+2*L10*L2*COS(EA-Q4-Q5-Q6-Q7)+2*L12*L6*COS(EA-FA-Q5-Q6-Q7
     &)-2*L10**2-L12**2-L2**2-L6**2-L8**2-2*L10*L8*COS(Q6)-2*L6*L8*COS(Q
     &5)-2*L10*L6*COS(Q5+Q6)-2*L10**2*COS(EA-Q7)-2*L10*L8*COS(EA-Q6-Q7)-
     &2*L10*L6*COS(EA-Q5-Q6-Q7)-2*L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7)) - IA - 
     &IB - IC - ID - IE - IF - IG - MA*L1**2 - MC*(L2**2+L6**2+L7**2+2*L
     &6*L7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) - 0.25D0*MB*(L3**
     &2+L4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(F
     &OOTANG+Q4)) - MD*(L2**2+L6**2+L8**2+L9**2+2*L6*L8*COS(Q5)+2*L8*L9*
     &COS(Q6)+2*L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*L2
     &*L9*COS(Q4+Q5+Q6)) - MG*(L10**2+L2**2+L6**2+L8**2+GS**2+2*L10*L8*C
     &OS(Q6)+2*L10*GS*COS(Q7)+2*L6*L8*COS(Q5)+2*L10*L6*COS(Q5+Q6)+2*L8*G
     &S*COS(Q6+Q7)+2*L6*GS*COS(Q5+Q6+Q7)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+
     &Q5)-2*L10*L2*COS(Q4+Q5+Q6)-2*L2*GS*COS(Q4+Q5+Q6+Q7)) - ME*(L10**2+
     &L2**2+L6**2+L8**2+(L10-L9)**2+2*L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+2*L
     &10*L6*COS(Q5+Q6)+2*L10*(L10-L9)*COS(EA-Q7)+2*L8*(L10-L9)*COS(EA-Q6
     &-Q7)+2*L6*(L10-L9)*COS(EA-Q5-Q6-Q7)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4
     &+Q5)-2*L10*L2*COS(Q4+Q5+Q6)-2*L2*(L10-L9)*COS(EA-Q4-Q5-Q6-Q7))
      COEF(3,4) = IA + MA*L1**2 + L2*MC*(L2-L6*COS(Q4)-L7*COS(Q4+Q5)) + 
     &0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q4)) + L2*MD*(L2-L6*CO
     &S(Q4)-L8*COS(Q4+Q5)-L9*COS(Q4+Q5+Q6)) + L2*MG*(L2-L6*COS(Q4)-L8*CO
     &S(Q4+Q5)-L10*COS(Q4+Q5+Q6)-GS*COS(Q4+Q5+Q6+Q7)) + L2*ME*(L2-L6*COS
     &(Q4)-L8*COS(Q4+Q5)-L10*COS(Q4+Q5+Q6)-(L10-L9)*COS(EA-Q4-Q5-Q6-Q7))
     & - L2*MF*(L6*COS(Q4)+L8*COS(Q4+Q5)+L10*COS(Q4+Q5+Q6)+L10*COS(EA-Q4
     &-Q5-Q6-Q7)-L2-L12*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(3,5) = IA + IB + MA*L1**2 + MC*(L2**2+L6**2+L6*L7*COS(Q5)-2*L
     &2*L6*COS(Q4)-L2*L7*COS(Q4+Q5)) + 0.25D0*MB*(L3**2+L4**2+4*L2**2+2*
     &L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4)) + MD*(
     &L2**2+L6**2+L6*L8*COS(Q5)+L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*C
     &OS(Q4+Q5)-L2*L9*COS(Q4+Q5+Q6)) + MG*(L2**2+L6**2+L6*L8*COS(Q5)+L10
     &*L6*COS(Q5+Q6)+L6*GS*COS(Q5+Q6+Q7)-2*L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5
     &)-L10*L2*COS(Q4+Q5+Q6)-L2*GS*COS(Q4+Q5+Q6+Q7)) + ME*(L2**2+L6**2+L
     &6*L8*COS(Q5)+L10*L6*COS(Q5+Q6)+L6*(L10-L9)*COS(EA-Q5-Q6-Q7)-2*L2*L
     &6*COS(Q4)-L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)-L2*(L10-L9)*COS(EA
     &-Q4-Q5-Q6-Q7)) - MF*(2*L2*L6*COS(Q4)+L2*L8*COS(Q4+Q5)+L10*L2*COS(Q
     &4+Q5+Q6)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*L6*COS(EA-FA-Q5-Q6-Q7)-L2*
     &*2-L6**2-L6*L8*COS(Q5)-L10*L6*COS(Q5+Q6)-L10*L6*COS(EA-Q5-Q6-Q7)-L
     &12*L2*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(3,6) = IA + IB + IC + MA*L1**2 + MC*(L2**2+L6**2+L7**2+2*L6*L
     &7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) + 0.25D0*MB*(L3**2+L
     &4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOT
     &ANG+Q4)) + MD*(L2**2+L6**2+L8**2+L8*L9*COS(Q6)+2*L6*L8*COS(Q5)+L6*
     &L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L2*L9*COS(Q4+Q5+Q
     &6)) + MG*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*
     &COS(Q5+Q6)+L8*GS*COS(Q6+Q7)+L6*GS*COS(Q5+Q6+Q7)-2*L2*L6*COS(Q4)-2*
     &L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)-L2*GS*COS(Q4+Q5+Q6+Q7)) + ME
     &*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*COS(Q5+Q
     &6)+L8*(L10-L9)*COS(EA-Q6-Q7)+L6*(L10-L9)*COS(EA-Q5-Q6-Q7)-2*L2*L6*
     &COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)-L2*(L10-L9)*COS(EA
     &-Q4-Q5-Q6-Q7)) - MF*(2*L2*L6*COS(Q4)+2*L2*L8*COS(Q4+Q5)+L10*L2*COS
     &(Q4+Q5+Q6)+L12*L8*COS(EA-FA-Q6-Q7)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*
     &L6*COS(EA-FA-Q5-Q6-Q7)-L2**2-L6**2-L8**2-2*L6*L8*COS(Q5)-L10*L8*CO
     &S(Q6)-L10*L6*COS(Q5+Q6)-L10*L8*COS(EA-Q6-Q7)-L10*L6*COS(EA-Q5-Q6-Q
     &7)-L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(3,7) = IA + IB + IC + ID + MA*L1**2 + MC*(L2**2+L6**2+L7**2+2
     &*L6*L7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) + 0.25D0*MB*(L3
     &**2+L4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS
     &(FOOTANG+Q4)) + MD*(L2**2+L6**2+L8**2+L9**2+2*L6*L8*COS(Q5)+2*L8*L
     &9*COS(Q6)+2*L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*
     &L2*L9*COS(Q4+Q5+Q6)) + MG*(L10**2+L2**2+L6**2+L8**2+L10*GS*COS(Q7)
     &+2*L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L8*GS*COS(Q6+Q7)+2*L10*L6*COS(Q5
     &+Q6)+L6*GS*COS(Q5+Q6+Q7)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*L10*
     &L2*COS(Q4+Q5+Q6)-L2*GS*COS(Q4+Q5+Q6+Q7)) + ME*(L10**2+L2**2+L6**2+
     &L8**2+2*L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+2*L10*L6*COS(Q5+Q6)+L10*(L1
     &0-L9)*COS(EA-Q7)+L8*(L10-L9)*COS(EA-Q6-Q7)+L6*(L10-L9)*COS(EA-Q5-Q
     &6-Q7)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*L10*L2*COS(Q4+Q5+Q6)-L2
     &*(L10-L9)*COS(EA-Q4-Q5-Q6-Q7)) - MF*(2*L2*L6*COS(Q4)+2*L2*L8*COS(Q
     &4+Q5)+2*L10*L2*COS(Q4+Q5+Q6)+L10*L12*COS(EA-FA-Q7)+L12*L8*COS(EA-F
     &A-Q6-Q7)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*L6*COS(EA-FA-Q5-Q6-Q7)-L10
     &**2-L2**2-L6**2-L8**2-2*L10*L8*COS(Q6)-2*L6*L8*COS(Q5)-2*L10*L6*CO
     &S(Q5+Q6)-L10**2*COS(EA-Q7)-L10*L8*COS(EA-Q6-Q7)-L10*L6*COS(EA-Q5-Q
     &6-Q7)-L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(4,1) = (L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)*SIN(Q3-Q4-
     &Q5-Q6-Q7)
      COEF(4,2) = -(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)*COS(Q3-Q4
     &-Q5-Q6-Q7)
      COEF(4,3) = IA + MA*L1**2 + L2*MC*(L2-L6*COS(Q4)-L7*COS(Q4+Q5)) + 
     &0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q4)) + L2*MD*(L2-L6*CO
     &S(Q4)-L8*COS(Q4+Q5)-L9*COS(Q4+Q5+Q6)) + L2*MG*(L2-L6*COS(Q4)-L8*CO
     &S(Q4+Q5)-L10*COS(Q4+Q5+Q6)-GS*COS(Q4+Q5+Q6+Q7)) + L2*ME*(L2-L6*COS
     &(Q4)-L8*COS(Q4+Q5)-L10*COS(Q4+Q5+Q6)-(L10-L9)*COS(EA-Q4-Q5-Q6-Q7))
     & - L2*MF*(L6*COS(Q4)+L8*COS(Q4+Q5)+L10*COS(Q4+Q5+Q6)+L10*COS(EA-Q4
     &-Q5-Q6-Q7)-L2-L12*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(4,4) = -IA - MA*L1**2 - MB*L2**2 - MC*L2**2 - MD*L2**2 - ME*L
     &2**2 - MF*L2**2 - MG*L2**2
      COEF(4,5) = -IA - MA*L1**2 - L2*MC*(L2-L6*COS(Q4)) - L2*MD*(L2-L6*
     &COS(Q4)) - L2*ME*(L2-L6*COS(Q4)) - L2*MF*(L2-L6*COS(Q4)) - L2*MG*(
     &L2-L6*COS(Q4)) - 0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q4))
      COEF(4,6) = -IA - MA*L1**2 - L2*MC*(L2-L6*COS(Q4)-L7*COS(Q4+Q5)) -
     & L2*MD*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)) - L2*ME*(L2-L6*COS(Q4)-L8*COS
     &(Q4+Q5)) - L2*MF*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)) - L2*MG*(L2-L6*COS(
     &Q4)-L8*COS(Q4+Q5)) - 0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q
     &4))
      COEF(4,7) = -IA - MA*L1**2 - L2*MC*(L2-L6*COS(Q4)-L7*COS(Q4+Q5)) -
     & 0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q4)) - L2*MD*(L2-L6*C
     &OS(Q4)-L8*COS(Q4+Q5)-L9*COS(Q4+Q5+Q6)) - L2*ME*(L2-L6*COS(Q4)-L8*C
     &OS(Q4+Q5)-L10*COS(Q4+Q5+Q6)) - L2*MF*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)-
     &L10*COS(Q4+Q5+Q6)) - L2*MG*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)-L10*COS(Q4
     &+Q5+Q6))
      COEF(5,1) = L1*MA*SIN(Q3-Q4-Q5-Q6-Q7) - MC*(L6*SIN(Q3-Q5-Q6-Q7)-L2
     &*SIN(Q3-Q4-Q5-Q6-Q7)) - MD*(L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6
     &-Q7)) - ME*(L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MF*(L6*S
     &IN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MG*(L6*SIN(Q3-Q5-Q6-Q7)-
     &L2*SIN(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*SIN(Q3-Q5-Q6-Q7)+L3*SIN(FOO
     &TANG+Q3-Q5-Q6-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7))
      COEF(5,2) = MC*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + MD*(
     &L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + ME*(L6*COS(Q3-Q5-Q6-
     &Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + MF*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4
     &-Q5-Q6-Q7)) + MG*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + 0.
     &5D0*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*COS(Q
     &3-Q4-Q5-Q6-Q7)) - L1*MA*COS(Q3-Q4-Q5-Q6-Q7)
      COEF(5,3) = IA + IB + MA*L1**2 + MC*(L2**2+L6**2+L6*L7*COS(Q5)-2*L
     &2*L6*COS(Q4)-L2*L7*COS(Q4+Q5)) + 0.25D0*MB*(L3**2+L4**2+4*L2**2+2*
     &L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4)) + MD*(
     &L2**2+L6**2+L6*L8*COS(Q5)+L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*C
     &OS(Q4+Q5)-L2*L9*COS(Q4+Q5+Q6)) + MG*(L2**2+L6**2+L6*L8*COS(Q5)+L10
     &*L6*COS(Q5+Q6)+L6*GS*COS(Q5+Q6+Q7)-2*L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5
     &)-L10*L2*COS(Q4+Q5+Q6)-L2*GS*COS(Q4+Q5+Q6+Q7)) + ME*(L2**2+L6**2+L
     &6*L8*COS(Q5)+L10*L6*COS(Q5+Q6)+L6*(L10-L9)*COS(EA-Q5-Q6-Q7)-2*L2*L
     &6*COS(Q4)-L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)-L2*(L10-L9)*COS(EA
     &-Q4-Q5-Q6-Q7)) - MF*(2*L2*L6*COS(Q4)+L2*L8*COS(Q4+Q5)+L10*L2*COS(Q
     &4+Q5+Q6)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*L6*COS(EA-FA-Q5-Q6-Q7)-L2*
     &*2-L6**2-L6*L8*COS(Q5)-L10*L6*COS(Q5+Q6)-L10*L6*COS(EA-Q5-Q6-Q7)-L
     &12*L2*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(5,4) = -IA - MA*L1**2 - L2*MC*(L2-L6*COS(Q4)) - L2*MD*(L2-L6*
     &COS(Q4)) - L2*ME*(L2-L6*COS(Q4)) - L2*MF*(L2-L6*COS(Q4)) - L2*MG*(
     &L2-L6*COS(Q4)) - 0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q4))
      COEF(5,5) = -IA - IB - MA*L1**2 - MC*(L2**2+L6**2-2*L2*L6*COS(Q4))
     & - MD*(L2**2+L6**2-2*L2*L6*COS(Q4)) - ME*(L2**2+L6**2-2*L2*L6*COS(
     &Q4)) - MF*(L2**2+L6**2-2*L2*L6*COS(Q4)) - MG*(L2**2+L6**2-2*L2*L6*
     &COS(Q4)) - 0.25D0*MB*(L3**2+L4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L
     &2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4))
      COEF(5,6) = -IA - IB - MA*L1**2 - MC*(L2**2+L6**2+L6*L7*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L7*COS(Q4+Q5)) - MD*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - ME*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - MF*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - MG*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - 0.25D0*MB*(L3**2+L4**2+4*L2**2+2
     &*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4))
      COEF(5,7) = -IA - IB - MA*L1**2 - MC*(L2**2+L6**2+L6*L7*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L7*COS(Q4+Q5)) - 0.25D0*MB*(L3**2+L4**2+4*L2**2+2
     &*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4)) - MD*
     &(L2**2+L6**2+L6*L8*COS(Q5)+L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*
     &COS(Q4+Q5)-L2*L9*COS(Q4+Q5+Q6)) - ME*(L2**2+L6**2+L6*L8*COS(Q5)+L1
     &0*L6*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+
     &Q6)) - MF*(L2**2+L6**2+L6*L8*COS(Q5)+L10*L6*COS(Q5+Q6)-2*L2*L6*COS
     &(Q4)-L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)) - MG*(L2**2+L6**2+L6*L
     &8*COS(Q5)+L10*L6*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)-L10*L
     &2*COS(Q4+Q5+Q6))
      COEF(6,1) = L1*MA*SIN(Q3-Q4-Q5-Q6-Q7) - MC*(L7*SIN(Q3-Q6-Q7)+L6*SI
     &N(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MD*(L8*SIN(Q3-Q6-Q7)+L6*S
     &IN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - ME*(L8*SIN(Q3-Q6-Q7)+L6*
     &SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MF*(L8*SIN(Q3-Q6-Q7)+L6
     &*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MG*(L8*SIN(Q3-Q6-Q7)+L
     &6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*SIN(Q3-Q
     &5-Q6-Q7)+L3*SIN(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7))
      COEF(6,2) = MC*(L7*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-
     &Q5-Q6-Q7)) + MD*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4
     &-Q5-Q6-Q7)) + ME*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q
     &4-Q5-Q6-Q7)) + MF*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-
     &Q4-Q5-Q6-Q7)) + MG*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3
     &-Q4-Q5-Q6-Q7)) + 0.5D0*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q
     &5-Q6-Q7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)) - L1*MA*COS(Q3-Q4-Q5-Q6-Q7)
      COEF(6,3) = IA + IB + IC + MA*L1**2 + MC*(L2**2+L6**2+L7**2+2*L6*L
     &7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) + 0.25D0*MB*(L3**2+L
     &4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOT
     &ANG+Q4)) + MD*(L2**2+L6**2+L8**2+L8*L9*COS(Q6)+2*L6*L8*COS(Q5)+L6*
     &L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L2*L9*COS(Q4+Q5+Q
     &6)) + MG*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*
     &COS(Q5+Q6)+L8*GS*COS(Q6+Q7)+L6*GS*COS(Q5+Q6+Q7)-2*L2*L6*COS(Q4)-2*
     &L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)-L2*GS*COS(Q4+Q5+Q6+Q7)) + ME
     &*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*COS(Q5+Q
     &6)+L8*(L10-L9)*COS(EA-Q6-Q7)+L6*(L10-L9)*COS(EA-Q5-Q6-Q7)-2*L2*L6*
     &COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)-L2*(L10-L9)*COS(EA
     &-Q4-Q5-Q6-Q7)) - MF*(2*L2*L6*COS(Q4)+2*L2*L8*COS(Q4+Q5)+L10*L2*COS
     &(Q4+Q5+Q6)+L12*L8*COS(EA-FA-Q6-Q7)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*
     &L6*COS(EA-FA-Q5-Q6-Q7)-L2**2-L6**2-L8**2-2*L6*L8*COS(Q5)-L10*L8*CO
     &S(Q6)-L10*L6*COS(Q5+Q6)-L10*L8*COS(EA-Q6-Q7)-L10*L6*COS(EA-Q5-Q6-Q
     &7)-L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(6,4) = -IA - MA*L1**2 - L2*MC*(L2-L6*COS(Q4)-L7*COS(Q4+Q5)) -
     & L2*MD*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)) - L2*ME*(L2-L6*COS(Q4)-L8*COS
     &(Q4+Q5)) - L2*MF*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)) - L2*MG*(L2-L6*COS(
     &Q4)-L8*COS(Q4+Q5)) - 0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q
     &4))
      COEF(6,5) = -IA - IB - MA*L1**2 - MC*(L2**2+L6**2+L6*L7*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L7*COS(Q4+Q5)) - MD*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - ME*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - MF*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - MG*(L2**2+L6**2+L6*L8*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)) - 0.25D0*MB*(L3**2+L4**2+4*L2**2+2
     &*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4))
      COEF(6,6) = -IA - IB - IC - MA*L1**2 - MC*(L2**2+L6**2+L7**2+2*L6*
     &L7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) - MD*(L2**2+L6**2+L
     &8**2+2*L6*L8*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)) - ME*(L2*
     &*2+L6**2+L8**2+2*L6*L8*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5))
     & - MF*(L2**2+L6**2+L8**2+2*L6*L8*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L8*C
     &OS(Q4+Q5)) - MG*(L2**2+L6**2+L8**2+2*L6*L8*COS(Q5)-2*L2*L6*COS(Q4)
     &-2*L2*L8*COS(Q4+Q5)) - 0.25D0*MB*(L3**2+L4**2+4*L2**2+2*L3*L4*COS(
     &FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4))
      COEF(6,7) = -IA - IB - IC - MA*L1**2 - MC*(L2**2+L6**2+L7**2+2*L6*
     &L7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) - 0.25D0*MB*(L3**2+
     &L4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOO
     &TANG+Q4)) - MD*(L2**2+L6**2+L8**2+L8*L9*COS(Q6)+2*L6*L8*COS(Q5)+L6
     &*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L2*L9*COS(Q4+Q5+
     &Q6)) - ME*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6
     &*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6
     &)) - MF*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*C
     &OS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6))
     & - MG*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*COS
     &(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6))
      COEF(7,1) = L1*MA*SIN(Q3-Q4-Q5-Q6-Q7) - MC*(L7*SIN(Q3-Q6-Q7)+L6*SI
     &N(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - 0.5D0*MB*(L4*SIN(Q3-Q5-Q6
     &-Q7)+L3*SIN(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MD*(L
     &9*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-
     &Q6-Q7)) - ME*(L10*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-
     &L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MF*(L10*SIN(Q3-Q7)+L8*SIN(Q3-Q6-Q7)+L6*S
     &IN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7)) - MG*(L10*SIN(Q3-Q7)+L8*SI
     &N(Q3-Q6-Q7)+L6*SIN(Q3-Q5-Q6-Q7)-L2*SIN(Q3-Q4-Q5-Q6-Q7))
      COEF(7,2) = MC*(L7*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-
     &Q5-Q6-Q7)) + 0.5D0*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6
     &-Q7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)) + MD*(L9*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7
     &)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + ME*(L10*COS(Q3-Q7)
     &+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + MF
     &*(L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4
     &-Q5-Q6-Q7)) + MG*(L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-
     &Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - L1*MA*COS(Q3-Q4-Q5-Q6-Q7)
      COEF(7,3) = IA + IB + IC + ID + MA*L1**2 + MC*(L2**2+L6**2+L7**2+2
     &*L6*L7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) + 0.25D0*MB*(L3
     &**2+L4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS
     &(FOOTANG+Q4)) + MD*(L2**2+L6**2+L8**2+L9**2+2*L6*L8*COS(Q5)+2*L8*L
     &9*COS(Q6)+2*L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*
     &L2*L9*COS(Q4+Q5+Q6)) + MG*(L10**2+L2**2+L6**2+L8**2+L10*GS*COS(Q7)
     &+2*L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L8*GS*COS(Q6+Q7)+2*L10*L6*COS(Q5
     &+Q6)+L6*GS*COS(Q5+Q6+Q7)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*L10*
     &L2*COS(Q4+Q5+Q6)-L2*GS*COS(Q4+Q5+Q6+Q7)) + ME*(L10**2+L2**2+L6**2+
     &L8**2+2*L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+2*L10*L6*COS(Q5+Q6)+L10*(L1
     &0-L9)*COS(EA-Q7)+L8*(L10-L9)*COS(EA-Q6-Q7)+L6*(L10-L9)*COS(EA-Q5-Q
     &6-Q7)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*L10*L2*COS(Q4+Q5+Q6)-L2
     &*(L10-L9)*COS(EA-Q4-Q5-Q6-Q7)) - MF*(2*L2*L6*COS(Q4)+2*L2*L8*COS(Q
     &4+Q5)+2*L10*L2*COS(Q4+Q5+Q6)+L10*L12*COS(EA-FA-Q7)+L12*L8*COS(EA-F
     &A-Q6-Q7)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*L6*COS(EA-FA-Q5-Q6-Q7)-L10
     &**2-L2**2-L6**2-L8**2-2*L10*L8*COS(Q6)-2*L6*L8*COS(Q5)-2*L10*L6*CO
     &S(Q5+Q6)-L10**2*COS(EA-Q7)-L10*L8*COS(EA-Q6-Q7)-L10*L6*COS(EA-Q5-Q
     &6-Q7)-L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7))
      COEF(7,4) = -IA - MA*L1**2 - L2*MC*(L2-L6*COS(Q4)-L7*COS(Q4+Q5)) -
     & 0.5D0*L2*MB*(2*L2-L4*COS(Q4)-L3*COS(FOOTANG+Q4)) - L2*MD*(L2-L6*C
     &OS(Q4)-L8*COS(Q4+Q5)-L9*COS(Q4+Q5+Q6)) - L2*ME*(L2-L6*COS(Q4)-L8*C
     &OS(Q4+Q5)-L10*COS(Q4+Q5+Q6)) - L2*MF*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)-
     &L10*COS(Q4+Q5+Q6)) - L2*MG*(L2-L6*COS(Q4)-L8*COS(Q4+Q5)-L10*COS(Q4
     &+Q5+Q6))
      COEF(7,5) = -IA - IB - MA*L1**2 - MC*(L2**2+L6**2+L6*L7*COS(Q5)-2*
     &L2*L6*COS(Q4)-L2*L7*COS(Q4+Q5)) - 0.25D0*MB*(L3**2+L4**2+4*L2**2+2
     &*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOOTANG+Q4)) - MD*
     &(L2**2+L6**2+L6*L8*COS(Q5)+L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*
     &COS(Q4+Q5)-L2*L9*COS(Q4+Q5+Q6)) - ME*(L2**2+L6**2+L6*L8*COS(Q5)+L1
     &0*L6*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+
     &Q6)) - MF*(L2**2+L6**2+L6*L8*COS(Q5)+L10*L6*COS(Q5+Q6)-2*L2*L6*COS
     &(Q4)-L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6)) - MG*(L2**2+L6**2+L6*L
     &8*COS(Q5)+L10*L6*COS(Q5+Q6)-2*L2*L6*COS(Q4)-L2*L8*COS(Q4+Q5)-L10*L
     &2*COS(Q4+Q5+Q6))
      COEF(7,6) = -IA - IB - IC - MA*L1**2 - MC*(L2**2+L6**2+L7**2+2*L6*
     &L7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) - 0.25D0*MB*(L3**2+
     &L4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*COS(FOO
     &TANG+Q4)) - MD*(L2**2+L6**2+L8**2+L8*L9*COS(Q6)+2*L6*L8*COS(Q5)+L6
     &*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L2*L9*COS(Q4+Q5+
     &Q6)) - ME*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6
     &*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6
     &)) - MF*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*C
     &OS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6))
     & - MG*(L2**2+L6**2+L8**2+L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+L10*L6*COS
     &(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-L10*L2*COS(Q4+Q5+Q6))
      COEF(7,7) = -IA - IB - IC - ID - MA*L1**2 - MC*(L2**2+L6**2+L7**2+
     &2*L6*L7*COS(Q5)-2*L2*L6*COS(Q4)-2*L2*L7*COS(Q4+Q5)) - 0.25D0*MB*(L
     &3**2+L4**2+4*L2**2+2*L3*L4*COS(FOOTANG)-4*L2*L4*COS(Q4)-4*L2*L3*CO
     &S(FOOTANG+Q4)) - MD*(L2**2+L6**2+L8**2+L9**2+2*L6*L8*COS(Q5)+2*L8*
     &L9*COS(Q6)+2*L6*L9*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2
     &*L2*L9*COS(Q4+Q5+Q6)) - ME*(L10**2+L2**2+L6**2+L8**2+2*L10*L8*COS(
     &Q6)+2*L6*L8*COS(Q5)+2*L10*L6*COS(Q5+Q6)-2*L2*L6*COS(Q4)-2*L2*L8*CO
     &S(Q4+Q5)-2*L10*L2*COS(Q4+Q5+Q6)) - MF*(L10**2+L2**2+L6**2+L8**2+2*
     &L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+2*L10*L6*COS(Q5+Q6)-2*L2*L6*COS(Q4)
     &-2*L2*L8*COS(Q4+Q5)-2*L10*L2*COS(Q4+Q5+Q6)) - MG*(L10**2+L2**2+L6*
     &*2+L8**2+2*L10*L8*COS(Q6)+2*L6*L8*COS(Q5)+2*L10*L6*COS(Q5+Q6)-2*L2
     &*L6*COS(Q4)-2*L2*L8*COS(Q4+Q5)-2*L10*L2*COS(Q4+Q5+Q6))
      RHS(1) = L1*MA*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2 - RX1 - RX2
     & - MC*(L7*COS(Q3-Q6-Q7)*(U3-U6-U7)**2+L6*COS(Q3-Q5-Q6-Q7)*(U3-U5-U
     &6-U7)**2-L2*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - 0.5D0*MB*(L
     &4*COS(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)**2+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)*(U
     &3-U5-U6-U7)**2-2*L2*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - MD*
     &(L9*COS(Q3-Q7)*(U3-U7)**2+L8*COS(Q3-Q6-Q7)*(U3-U6-U7)**2+L6*COS(Q3
     &-Q5-Q6-Q7)*(U3-U5-U6-U7)**2-L2*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7
     &)**2) - MG*(2*GSp*SIN(Q3)*U3+L10*COS(Q3-Q7)*(U3-U7)**2+L8*COS(Q3-Q
     &6-Q7)*(U3-U6-U7)**2+L6*COS(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)**2-COS(Q3)*(
     &GSpp-GS*U3**2)-L2*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - ME*((
     &L10-L9)*EApp*SIN(EA-Q3)+L10*COS(Q3-Q7)*(U3-U7)**2+(L10-L9)*COS(EA-
     &Q3)*(EAp-U3)**2+L8*COS(Q3-Q6-Q7)*(U3-U6-U7)**2+L6*COS(Q3-Q5-Q6-Q7)
     &*(U3-U5-U6-U7)**2-L2*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - MF
     &*(L10*EApp*SIN(EA-Q3)+L10*COS(EA-Q3)*(EAp-U3)**2+L10*COS(Q3-Q7)*(U
     &3-U7)**2+L8*COS(Q3-Q6-Q7)*(U3-U6-U7)**2+L6*COS(Q3-Q5-Q6-Q7)*(U3-U5
     &-U6-U7)**2-L12*(EApp-FApp)*SIN(EA-FA-Q3)-L12*COS(EA-FA-Q3)*(EAp-FA
     &p-U3)**2-L2*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2)
      RHS(2) = L1*MA*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2 - G*MA - G*
     &MB - G*MC - G*MD - G*ME - G*MF - G*MG - RY1 - RY2 - MC*(L7*SIN(Q3-
     &Q6-Q7)*(U3-U6-U7)**2+L6*SIN(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)**2-L2*SIN(Q
     &3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - 0.5D0*MB*(L4*SIN(Q3-Q5-Q6-Q7
     &)*(U3-U5-U6-U7)**2+L3*SIN(FOOTANG+Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)**2-2*
     &L2*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - MD*(L9*SIN(Q3-Q7)*(U
     &3-U7)**2+L8*SIN(Q3-Q6-Q7)*(U3-U6-U7)**2+L6*SIN(Q3-Q5-Q6-Q7)*(U3-U5
     &-U6-U7)**2-L2*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - MG*(L10*S
     &IN(Q3-Q7)*(U3-U7)**2+L8*SIN(Q3-Q6-Q7)*(U3-U6-U7)**2+L6*SIN(Q3-Q5-Q
     &6-Q7)*(U3-U5-U6-U7)**2-2*GSp*COS(Q3)*U3-SIN(Q3)*(GSpp-GS*U3**2)-L2
     &*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - ME*((L10-L9)*EApp*COS(
     &EA-Q3)+L10*SIN(Q3-Q7)*(U3-U7)**2+L8*SIN(Q3-Q6-Q7)*(U3-U6-U7)**2+L6
     &*SIN(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)**2-(L10-L9)*SIN(EA-Q3)*(EAp-U3)**2
     &-L2*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - MF*(L10*EApp*COS(EA
     &-Q3)+L10*SIN(Q3-Q7)*(U3-U7)**2+L12*SIN(EA-FA-Q3)*(EAp-FAp-U3)**2+L
     &8*SIN(Q3-Q6-Q7)*(U3-U6-U7)**2+L6*SIN(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)**2
     &-L12*(EApp-FApp)*COS(EA-FA-Q3)-L10*SIN(EA-Q3)*(EAp-U3)**2-L2*SIN(Q
     &3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2)
      RHS(3) = G*L1*MA*COS(Q3-Q4-Q5-Q6-Q7) + 0.5D0*L2*MB*(L4*SIN(Q4)*(U3
     &-U5-U6-U7)**2+L3*SIN(FOOTANG+Q4)*(U3-U5-U6-U7)**2-L4*SIN(Q4)*(U3-U
     &4-U5-U6-U7)**2-L3*SIN(FOOTANG+Q4)*(U3-U4-U5-U6-U7)**2) + MC*(L2*L7
     &*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L7*SIN
     &(Q5)*(U3-U5-U6-U7)**2-L6*L7*SIN(Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(U
     &3-U4-U5-U6-U7)**2-L2*L7*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2) + MD*(L2*L
     &9*SIN(Q4+Q5+Q6)*(U3-U7)**2+L8*L9*SIN(Q6)*(U3-U6-U7)**2+L2*L8*SIN(Q
     &4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L8*SIN(Q5)*(
     &U3-U5-U6-U7)**2+L6*L9*SIN(Q5+Q6)*(U3-U5-U6-U7)**2-L8*L9*SIN(Q6)*(U
     &3-U7)**2-L6*L9*SIN(Q5+Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L
     &2*L6*SIN(Q4)*(U3-U4-U5-U6-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)
     &**2-L2*L9*SIN(Q4+Q5+Q6)*(U3-U4-U5-U6-U7)**2) + MG*(2*GS*GSp*U3+2*L
     &10*GSp*COS(Q7)*U3+2*L8*GSp*COS(Q6+Q7)*U3+2*L6*GSp*COS(Q5+Q6+Q7)*U3
     &+L10*SIN(Q7)*(GSpp-GS*U3**2)+L10*GS*SIN(Q7)*(U3-U7)**2+L8*SIN(Q6+Q
     &7)*(GSpp-GS*U3**2)+L10*L2*SIN(Q4+Q5+Q6)*(U3-U7)**2+L10*L8*SIN(Q6)*
     &(U3-U6-U7)**2+L6*SIN(Q5+Q6+Q7)*(GSpp-GS*U3**2)+L2*L8*SIN(Q4+Q5)*(U
     &3-U6-U7)**2+L8*GS*SIN(Q6+Q7)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6
     &-U7)**2+L6*L8*SIN(Q5)*(U3-U5-U6-U7)**2+L10*L6*SIN(Q5+Q6)*(U3-U5-U6
     &-U7)**2+L6*GS*SIN(Q5+Q6+Q7)*(U3-U5-U6-U7)**2-2*L2*GSp*COS(Q4+Q5+Q6
     &+Q7)*U3-L10*L8*SIN(Q6)*(U3-U7)**2-L10*L6*SIN(Q5+Q6)*(U3-U7)**2-L6*
     &L8*SIN(Q5)*(U3-U6-U7)**2-L2*SIN(Q4+Q5+Q6+Q7)*(GSpp-GS*U3**2)-L2*L6
     &*SIN(Q4)*(U3-U4-U5-U6-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2-
     &L10*L2*SIN(Q4+Q5+Q6)*(U3-U4-U5-U6-U7)**2-L2*GS*SIN(Q4+Q5+Q6+Q7)*(U
     &3-U4-U5-U6-U7)**2) + MF*(L10*L12*COS(FA)*EApp+L10*L12*COS(FA)*(EAp
     &p-FApp)+L10*L12*(EApp-FApp)*COS(EA-FA-Q7)+L10*L2*EApp*COS(EA-Q4-Q5
     &-Q6-Q7)+L12*L8*(EApp-FApp)*COS(EA-FA-Q6-Q7)+L12*L6*(EApp-FApp)*COS
     &(EA-FA-Q5-Q6-Q7)+L10*L12*SIN(FA)*(EAp-FAp-U3)**2+L10*L2*SIN(Q4+Q5+
     &Q6)*(U3-U7)**2+L10*L8*SIN(Q6)*(U3-U6-U7)**2+L10**2*SIN(EA-Q7)*(EAp
     &-U3)**2+L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2+L10*L12*SIN(EA-FA-Q7)*(U3-U
     &7)**2+L10*L8*SIN(EA-Q6-Q7)*(EAp-U3)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)
     &**2+L6*L8*SIN(Q5)*(U3-U5-U6-U7)**2+L10*L6*SIN(Q5+Q6)*(U3-U5-U6-U7)
     &**2+L10*L6*SIN(EA-Q5-Q6-Q7)*(EAp-U3)**2+L12*L8*SIN(EA-FA-Q6-Q7)*(U
     &3-U6-U7)**2+L12*L2*SIN(EA-FA-Q4-Q5-Q6-Q7)*(EAp-FAp-U3)**2+L12*L6*S
     &IN(EA-FA-Q5-Q6-Q7)*(U3-U5-U6-U7)**2+L10*L2*SIN(EA-Q4-Q5-Q6-Q7)*(U3
     &-U4-U5-U6-U7)**2-L10**2*EApp-L12**2*(EApp-FApp)-L10**2*EApp*COS(EA
     &-Q7)-L10*L8*EApp*COS(EA-Q6-Q7)-L10*L6*EApp*COS(EA-Q5-Q6-Q7)-L12*L2
     &*(EApp-FApp)*COS(EA-FA-Q4-Q5-Q6-Q7)-L10*L12*SIN(FA)*(EAp-U3)**2-L1
     &0*L8*SIN(Q6)*(U3-U7)**2-L10*L6*SIN(Q5+Q6)*(U3-U7)**2-L10**2*SIN(EA
     &-Q7)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L10*L12*SIN(EA-FA-Q7)*
     &(EAp-FAp-U3)**2-L10*L8*SIN(EA-Q6-Q7)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(
     &U3-U4-U5-U6-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2-L10*L2*SIN
     &(EA-Q4-Q5-Q6-Q7)*(EAp-U3)**2-L10*L2*SIN(Q4+Q5+Q6)*(U3-U4-U5-U6-U7)
     &**2-L12*L8*SIN(EA-FA-Q6-Q7)*(EAp-FAp-U3)**2-L10*L6*SIN(EA-Q5-Q6-Q7
     &)*(U3-U5-U6-U7)**2-L12*L6*SIN(EA-FA-Q5-Q6-Q7)*(EAp-FAp-U3)**2-L12*
     &L2*SIN(EA-FA-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - IE*EApp - IF*(EAp
     &p-FApp) - L2*(RX2*SIN(Q3-Q4-Q5-Q6-Q7)-RY2*COS(Q3-Q4-Q5-Q6-Q7)) - G
     &*MC*(L7*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) 
     &- 0.5D0*G*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)-2*L2
     &*COS(Q3-Q4-Q5-Q6-Q7)) - G*MD*(L9*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*CO
     &S(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - G*MG*(GS*COS(Q3)+L10*COS(
     &Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)
     &) - G*ME*(L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+(L10-L9)*COS(EA-Q3)+L6*C
     &OS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) - G*MF*(L10*COS(EA-Q3)+L10
     &*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L12*COS(EA-FA-Q3)
     &-L2*COS(Q3-Q4-Q5-Q6-Q7)) - ME*((L10-L9)**2*EApp+L10*(L10-L9)*EApp*
     &COS(EA-Q7)+L8*(L10-L9)*EApp*COS(EA-Q6-Q7)+L6*(L10-L9)*EApp*COS(EA-
     &Q5-Q6-Q7)+L10*L8*SIN(Q6)*(U3-U7)**2+L10*L6*SIN(Q5+Q6)*(U3-U7)**2+L
     &6*L8*SIN(Q5)*(U3-U6-U7)**2+L10*(L10-L9)*SIN(EA-Q7)*(U3-U7)**2+L2*L
     &6*SIN(Q4)*(U3-U4-U5-U6-U7)**2+L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2
     &+L10*L2*SIN(Q4+Q5+Q6)*(U3-U4-U5-U6-U7)**2+L8*(L10-L9)*SIN(EA-Q6-Q7
     &)*(U3-U6-U7)**2+L2*(L10-L9)*SIN(EA-Q4-Q5-Q6-Q7)*(EAp-U3)**2+L6*(L1
     &0-L9)*SIN(EA-Q5-Q6-Q7)*(U3-U5-U6-U7)**2-L2*(L10-L9)*EApp*COS(EA-Q4
     &-Q5-Q6-Q7)-L10*L2*SIN(Q4+Q5+Q6)*(U3-U7)**2-L10*L8*SIN(Q6)*(U3-U6-U
     &7)**2-L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(U3-U5-U6-U7)**
     &2-L6*L8*SIN(Q5)*(U3-U5-U6-U7)**2-L10*(L10-L9)*SIN(EA-Q7)*(EAp-U3)*
     &*2-L10*L6*SIN(Q5+Q6)*(U3-U5-U6-U7)**2-L8*(L10-L9)*SIN(EA-Q6-Q7)*(E
     &Ap-U3)**2-L6*(L10-L9)*SIN(EA-Q5-Q6-Q7)*(EAp-U3)**2-L2*(L10-L9)*SIN
     &(EA-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2)
      RHS(4) = L2*(RX2*SIN(Q3-Q4-Q5-Q6-Q7)-RY2*COS(Q3-Q4-Q5-Q6-Q7)) - MT
     &OR - G*L1*MA*COS(Q3-Q4-Q5-Q6-Q7) - G*L2*MB*COS(Q3-Q4-Q5-Q6-Q7) - G
     &*L2*MC*COS(Q3-Q4-Q5-Q6-Q7) - G*L2*MD*COS(Q3-Q4-Q5-Q6-Q7) - G*L2*ME
     &*COS(Q3-Q4-Q5-Q6-Q7) - G*L2*MF*COS(Q3-Q4-Q5-Q6-Q7) - G*L2*MG*COS(Q
     &3-Q4-Q5-Q6-Q7) - 0.5D0*L2*(MB*(L4*SIN(Q4)+L3*SIN(FOOTANG+Q4))*(U3-
     &U5-U6-U7)**2+2*MC*(L7*SIN(Q4+Q5)*(U3-U6-U7)**2+L6*SIN(Q4)*(U3-U5-U
     &6-U7)**2)+2*MD*(L9*SIN(Q4+Q5+Q6)*(U3-U7)**2+L8*SIN(Q4+Q5)*(U3-U6-U
     &7)**2+L6*SIN(Q4)*(U3-U5-U6-U7)**2)+2*ME*((L10-L9)*EApp*COS(EA-Q4-Q
     &5-Q6-Q7)+L10*SIN(Q4+Q5+Q6)*(U3-U7)**2+L8*SIN(Q4+Q5)*(U3-U6-U7)**2+
     &L6*SIN(Q4)*(U3-U5-U6-U7)**2-(L10-L9)*SIN(EA-Q4-Q5-Q6-Q7)*(EAp-U3)*
     &*2)-2*MG*(2*GSp*COS(Q4+Q5+Q6+Q7)*U3+SIN(Q4+Q5+Q6+Q7)*(GSpp-GS*U3**
     &2)-L10*SIN(Q4+Q5+Q6)*(U3-U7)**2-L8*SIN(Q4+Q5)*(U3-U6-U7)**2-L6*SIN
     &(Q4)*(U3-U5-U6-U7)**2)-2*MF*(L12*(EApp-FApp)*COS(EA-FA-Q4-Q5-Q6-Q7
     &)+L10*SIN(EA-Q4-Q5-Q6-Q7)*(EAp-U3)**2-L10*EApp*COS(EA-Q4-Q5-Q6-Q7)
     &-L10*SIN(Q4+Q5+Q6)*(U3-U7)**2-L8*SIN(Q4+Q5)*(U3-U6-U7)**2-L6*SIN(Q
     &4)*(U3-U5-U6-U7)**2-L12*SIN(EA-FA-Q4-Q5-Q6-Q7)*(EAp-FAp-U3)**2))
      RHS(5) = G*MC*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + G*MD*
     &(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + G*ME*(L6*COS(Q3-Q5-
     &Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + G*MF*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(
     &Q3-Q4-Q5-Q6-Q7)) + G*MG*(L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7
     &)) + L2*(RX2*SIN(Q3-Q4-Q5-Q6-Q7)-RY2*COS(Q3-Q4-Q5-Q6-Q7)) + 0.5D0*
     &G*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*COS(Q3-
     &Q4-Q5-Q6-Q7)) + MF*(L10*L6*EApp*COS(EA-Q5-Q6-Q7)+L12*L2*(EApp-FApp
     &)*COS(EA-FA-Q4-Q5-Q6-Q7)+L10*L6*SIN(Q5+Q6)*(U3-U7)**2+L6*L8*SIN(Q5
     &)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U4-U5-U6-U7)**2+L10*L2*SIN(EA-Q4
     &-Q5-Q6-Q7)*(EAp-U3)**2+L12*L6*SIN(EA-FA-Q5-Q6-Q7)*(EAp-FAp-U3)**2-
     &L10*L2*EApp*COS(EA-Q4-Q5-Q6-Q7)-L12*L6*(EApp-FApp)*COS(EA-FA-Q5-Q6
     &-Q7)-L10*L2*SIN(Q4+Q5+Q6)*(U3-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**
     &2-L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2-L10*L6*SIN(EA-Q5-Q6-Q7)*(EAp-U3)*
     &*2-L12*L2*SIN(EA-FA-Q4-Q5-Q6-Q7)*(EAp-FAp-U3)**2) - ATOR - G*L1*MA
     &*COS(Q3-Q4-Q5-Q6-Q7) - MC*(L2*L7*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SI
     &N(Q4)*(U3-U5-U6-U7)**2-L6*L7*SIN(Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(
     &U3-U4-U5-U6-U7)**2) - 0.5D0*L2*MB*(L4*SIN(Q4)*(U3-U5-U6-U7)**2+L3*
     &SIN(FOOTANG+Q4)*(U3-U5-U6-U7)**2-L4*SIN(Q4)*(U3-U4-U5-U6-U7)**2-L3
     &*SIN(FOOTANG+Q4)*(U3-U4-U5-U6-U7)**2) - MD*(L2*L9*SIN(Q4+Q5+Q6)*(U
     &3-U7)**2+L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7
     &)**2-L6*L9*SIN(Q5+Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L2*L6
     &*SIN(Q4)*(U3-U4-U5-U6-U7)**2) - MG*(2*L6*GSp*COS(Q5+Q6+Q7)*U3+L10*
     &L2*SIN(Q4+Q5+Q6)*(U3-U7)**2+L6*SIN(Q5+Q6+Q7)*(GSpp-GS*U3**2)+L2*L8
     &*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2-2*L2*GSp*
     &COS(Q4+Q5+Q6+Q7)*U3-L10*L6*SIN(Q5+Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3
     &-U6-U7)**2-L2*SIN(Q4+Q5+Q6+Q7)*(GSpp-GS*U3**2)-L2*L6*SIN(Q4)*(U3-U
     &4-U5-U6-U7)**2) - ME*(L2*(L10-L9)*EApp*COS(EA-Q4-Q5-Q6-Q7)+L10*L2*
     &SIN(Q4+Q5+Q6)*(U3-U7)**2+L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(
     &Q4)*(U3-U5-U6-U7)**2+L6*(L10-L9)*SIN(EA-Q5-Q6-Q7)*(EAp-U3)**2-L6*(
     &L10-L9)*EApp*COS(EA-Q5-Q6-Q7)-L10*L6*SIN(Q5+Q6)*(U3-U7)**2-L6*L8*S
     &IN(Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(U3-U4-U5-U6-U7)**2-L2*(L10-L9)
     &*SIN(EA-Q4-Q5-Q6-Q7)*(EAp-U3)**2)
      RHS(6) = KTOR + L2*(RX2*SIN(Q3-Q4-Q5-Q6-Q7)-RY2*COS(Q3-Q4-Q5-Q6-Q7
     &)) + G*MC*(L7*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6
     &-Q7)) + G*MD*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5
     &-Q6-Q7)) + G*ME*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4
     &-Q5-Q6-Q7)) + G*MF*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3
     &-Q4-Q5-Q6-Q7)) + G*MG*(L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS
     &(Q3-Q4-Q5-Q6-Q7)) + 0.5D0*G*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG
     &+Q3-Q5-Q6-Q7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)) + MF*(L10*L8*EApp*COS(EA-Q
     &6-Q7)+L10*L6*EApp*COS(EA-Q5-Q6-Q7)+L12*L2*(EApp-FApp)*COS(EA-FA-Q4
     &-Q5-Q6-Q7)+L10*L8*SIN(Q6)*(U3-U7)**2+L10*L6*SIN(Q5+Q6)*(U3-U7)**2+
     &L6*L8*SIN(Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U4-U5-U6-U7)**2+L2*L
     &8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2+L10*L2*SIN(EA-Q4-Q5-Q6-Q7)*(EAp-U
     &3)**2+L12*L8*SIN(EA-FA-Q6-Q7)*(EAp-FAp-U3)**2+L12*L6*SIN(EA-FA-Q5-
     &Q6-Q7)*(EAp-FAp-U3)**2-L10*L2*EApp*COS(EA-Q4-Q5-Q6-Q7)-L12*L8*(EAp
     &p-FApp)*COS(EA-FA-Q6-Q7)-L12*L6*(EApp-FApp)*COS(EA-FA-Q5-Q6-Q7)-L1
     &0*L2*SIN(Q4+Q5+Q6)*(U3-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2-L10*L
     &8*SIN(EA-Q6-Q7)*(EAp-U3)**2-L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2-L6*L8*S
     &IN(Q5)*(U3-U5-U6-U7)**2-L10*L6*SIN(EA-Q5-Q6-Q7)*(EAp-U3)**2-L12*L2
     &*SIN(EA-FA-Q4-Q5-Q6-Q7)*(EAp-FAp-U3)**2) - G*L1*MA*COS(Q3-Q4-Q5-Q6
     &-Q7) - 0.5D0*L2*MB*(L4*SIN(Q4)*(U3-U5-U6-U7)**2+L3*SIN(FOOTANG+Q4)
     &*(U3-U5-U6-U7)**2-L4*SIN(Q4)*(U3-U4-U5-U6-U7)**2-L3*SIN(FOOTANG+Q4
     &)*(U3-U4-U5-U6-U7)**2) - MC*(L2*L7*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*
     &SIN(Q4)*(U3-U5-U6-U7)**2+L6*L7*SIN(Q5)*(U3-U5-U6-U7)**2-L6*L7*SIN(
     &Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(U3-U4-U5-U6-U7)**2-L2*L7*SIN(Q4+Q
     &5)*(U3-U4-U5-U6-U7)**2) - MD*(L2*L9*SIN(Q4+Q5+Q6)*(U3-U7)**2+L2*L8
     &*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L8*SIN
     &(Q5)*(U3-U5-U6-U7)**2-L8*L9*SIN(Q6)*(U3-U7)**2-L6*L9*SIN(Q5+Q6)*(U
     &3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(U3-U4-U5-U6-U7
     &)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2) - MG*(2*L8*GSp*COS(Q6+Q
     &7)*U3+2*L6*GSp*COS(Q5+Q6+Q7)*U3+L8*SIN(Q6+Q7)*(GSpp-GS*U3**2)+L10*
     &L2*SIN(Q4+Q5+Q6)*(U3-U7)**2+L6*SIN(Q5+Q6+Q7)*(GSpp-GS*U3**2)+L2*L8
     &*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L8*SIN
     &(Q5)*(U3-U5-U6-U7)**2-2*L2*GSp*COS(Q4+Q5+Q6+Q7)*U3-L10*L8*SIN(Q6)*
     &(U3-U7)**2-L10*L6*SIN(Q5+Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**
     &2-L2*SIN(Q4+Q5+Q6+Q7)*(GSpp-GS*U3**2)-L2*L6*SIN(Q4)*(U3-U4-U5-U6-U
     &7)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2) - ME*(L2*(L10-L9)*EApp
     &*COS(EA-Q4-Q5-Q6-Q7)+L10*L2*SIN(Q4+Q5+Q6)*(U3-U7)**2+L2*L8*SIN(Q4+
     &Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L8*SIN(Q5)*(U3
     &-U5-U6-U7)**2+L8*(L10-L9)*SIN(EA-Q6-Q7)*(EAp-U3)**2+L6*(L10-L9)*SI
     &N(EA-Q5-Q6-Q7)*(EAp-U3)**2-L8*(L10-L9)*EApp*COS(EA-Q6-Q7)-L6*(L10-
     &L9)*EApp*COS(EA-Q5-Q6-Q7)-L10*L8*SIN(Q6)*(U3-U7)**2-L10*L6*SIN(Q5+
     &Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(U3-U4-U5
     &-U6-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2-L2*(L10-L9)*SIN(EA
     &-Q4-Q5-Q6-Q7)*(EAp-U3)**2)
      RHS(7) = L2*(RX2*SIN(Q3-Q4-Q5-Q6-Q7)-RY2*COS(Q3-Q4-Q5-Q6-Q7)) + G*
     &MC*(L7*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) +
     & 0.5D0*G*MB*(L4*COS(Q3-Q5-Q6-Q7)+L3*COS(FOOTANG+Q3-Q5-Q6-Q7)-2*L2*
     &COS(Q3-Q4-Q5-Q6-Q7)) + G*MD*(L9*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS
     &(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + G*ME*(L10*COS(Q3-Q7)+L8*CO
     &S(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + G*MF*(L1
     &0*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7)-L2*COS(Q3-Q4-Q5-
     &Q6-Q7)) + G*MG*(L10*COS(Q3-Q7)+L8*COS(Q3-Q6-Q7)+L6*COS(Q3-Q5-Q6-Q7
     &)-L2*COS(Q3-Q4-Q5-Q6-Q7)) + MF*(L10**2*EApp*COS(EA-Q7)+L10*L8*EApp
     &*COS(EA-Q6-Q7)+L10*L6*EApp*COS(EA-Q5-Q6-Q7)+L12*L2*(EApp-FApp)*COS
     &(EA-FA-Q4-Q5-Q6-Q7)+L10*L8*SIN(Q6)*(U3-U7)**2+L10*L6*SIN(Q5+Q6)*(U
     &3-U7)**2+L6*L8*SIN(Q5)*(U3-U6-U7)**2+L10*L12*SIN(EA-FA-Q7)*(EAp-FA
     &p-U3)**2+L2*L6*SIN(Q4)*(U3-U4-U5-U6-U7)**2+L2*L8*SIN(Q4+Q5)*(U3-U4
     &-U5-U6-U7)**2+L10*L2*SIN(EA-Q4-Q5-Q6-Q7)*(EAp-U3)**2+L10*L2*SIN(Q4
     &+Q5+Q6)*(U3-U4-U5-U6-U7)**2+L12*L8*SIN(EA-FA-Q6-Q7)*(EAp-FAp-U3)**
     &2+L12*L6*SIN(EA-FA-Q5-Q6-Q7)*(EAp-FAp-U3)**2-L10*L12*(EApp-FApp)*C
     &OS(EA-FA-Q7)-L10*L2*EApp*COS(EA-Q4-Q5-Q6-Q7)-L12*L8*(EApp-FApp)*CO
     &S(EA-FA-Q6-Q7)-L12*L6*(EApp-FApp)*COS(EA-FA-Q5-Q6-Q7)-L10*L2*SIN(Q
     &4+Q5+Q6)*(U3-U7)**2-L10*L8*SIN(Q6)*(U3-U6-U7)**2-L10**2*SIN(EA-Q7)
     &*(EAp-U3)**2-L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2-L10*L8*SIN(EA-Q6-Q7)*(
     &EAp-U3)**2-L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2-L6*L8*SIN(Q5)*(U3-U5-U6-
     &U7)**2-L10*L6*SIN(Q5+Q6)*(U3-U5-U6-U7)**2-L10*L6*SIN(EA-Q5-Q6-Q7)*
     &(EAp-U3)**2-L12*L2*SIN(EA-FA-Q4-Q5-Q6-Q7)*(EAp-FAp-U3)**2) - HTOR 
     &- G*L1*MA*COS(Q3-Q4-Q5-Q6-Q7) - 0.5D0*L2*MB*(L4*SIN(Q4)*(U3-U5-U6-
     &U7)**2+L3*SIN(FOOTANG+Q4)*(U3-U5-U6-U7)**2-L4*SIN(Q4)*(U3-U4-U5-U6
     &-U7)**2-L3*SIN(FOOTANG+Q4)*(U3-U4-U5-U6-U7)**2) - MC*(L2*L7*SIN(Q4
     &+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L7*SIN(Q5)*(U
     &3-U5-U6-U7)**2-L6*L7*SIN(Q5)*(U3-U6-U7)**2-L2*L6*SIN(Q4)*(U3-U4-U5
     &-U6-U7)**2-L2*L7*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2) - MD*(L2*L9*SIN(Q
     &4+Q5+Q6)*(U3-U7)**2+L8*L9*SIN(Q6)*(U3-U6-U7)**2+L2*L8*SIN(Q4+Q5)*(
     &U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L8*SIN(Q5)*(U3-U5-U
     &6-U7)**2+L6*L9*SIN(Q5+Q6)*(U3-U5-U6-U7)**2-L8*L9*SIN(Q6)*(U3-U7)**
     &2-L6*L9*SIN(Q5+Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L2*L6*SI
     &N(Q4)*(U3-U4-U5-U6-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2-L2*
     &L9*SIN(Q4+Q5+Q6)*(U3-U4-U5-U6-U7)**2) - MG*(2*L10*GSp*COS(Q7)*U3+2
     &*L8*GSp*COS(Q6+Q7)*U3+2*L6*GSp*COS(Q5+Q6+Q7)*U3+L10*SIN(Q7)*(GSpp-
     &GS*U3**2)+L8*SIN(Q6+Q7)*(GSpp-GS*U3**2)+L10*L2*SIN(Q4+Q5+Q6)*(U3-U
     &7)**2+L10*L8*SIN(Q6)*(U3-U6-U7)**2+L6*SIN(Q5+Q6+Q7)*(GSpp-GS*U3**2
     &)+L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2+L2*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6
     &*L8*SIN(Q5)*(U3-U5-U6-U7)**2+L10*L6*SIN(Q5+Q6)*(U3-U5-U6-U7)**2-2*
     &L2*GSp*COS(Q4+Q5+Q6+Q7)*U3-L10*L8*SIN(Q6)*(U3-U7)**2-L10*L6*SIN(Q5
     &+Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L2*SIN(Q4+Q5+Q6+Q7)*(G
     &Spp-GS*U3**2)-L2*L6*SIN(Q4)*(U3-U4-U5-U6-U7)**2-L2*L8*SIN(Q4+Q5)*(
     &U3-U4-U5-U6-U7)**2-L10*L2*SIN(Q4+Q5+Q6)*(U3-U4-U5-U6-U7)**2) - ME*
     &(L2*(L10-L9)*EApp*COS(EA-Q4-Q5-Q6-Q7)+L10*L2*SIN(Q4+Q5+Q6)*(U3-U7)
     &**2+L10*L8*SIN(Q6)*(U3-U6-U7)**2+L2*L8*SIN(Q4+Q5)*(U3-U6-U7)**2+L2
     &*L6*SIN(Q4)*(U3-U5-U6-U7)**2+L6*L8*SIN(Q5)*(U3-U5-U6-U7)**2+L10*(L
     &10-L9)*SIN(EA-Q7)*(EAp-U3)**2+L10*L6*SIN(Q5+Q6)*(U3-U5-U6-U7)**2+L
     &8*(L10-L9)*SIN(EA-Q6-Q7)*(EAp-U3)**2+L6*(L10-L9)*SIN(EA-Q5-Q6-Q7)*
     &(EAp-U3)**2-L10*(L10-L9)*EApp*COS(EA-Q7)-L8*(L10-L9)*EApp*COS(EA-Q
     &6-Q7)-L6*(L10-L9)*EApp*COS(EA-Q5-Q6-Q7)-L10*L8*SIN(Q6)*(U3-U7)**2-
     &L10*L6*SIN(Q5+Q6)*(U3-U7)**2-L6*L8*SIN(Q5)*(U3-U6-U7)**2-L2*L6*SIN
     &(Q4)*(U3-U4-U5-U6-U7)**2-L2*L8*SIN(Q4+Q5)*(U3-U4-U5-U6-U7)**2-L10*
     &L2*SIN(Q4+Q5+Q6)*(U3-U4-U5-U6-U7)**2-L2*(L10-L9)*SIN(EA-Q4-Q5-Q6-Q
     &7)*(EAp-U3)**2)
      CALL SOLVE(7,COEF,RHS,VARp)

C**   Update variables after uncoupling equations
      U1p = VARp(1)
      U2p = VARp(2)
      U3p = VARp(3)
      U4p = VARp(4)
      U5p = VARp(5)
      U6p = VARp(6)
      U7p = VARp(7)

C**   Update derivative array prior to integration step
      VARp(1) = Q1p
      VARp(2) = Q2p
      VARp(3) = Q3p
      VARp(4) = Q4p
      VARp(5) = Q5p
      VARp(6) = Q6p
      VARp(7) = Q7p
      VARp(8) = U1p
      VARp(9) = U2p
      VARp(10) = U3p
      VARp(11) = U4p
      VARp(12) = U5p
      VARp(13) = U6p
      VARp(14) = U7p

      RETURN
      END


C**********************************************************************
      SUBROUTINE       IO(T)
      IMPLICIT         DOUBLE PRECISION (A - Z)
      INTEGER          ILOOP
      COMMON/CONSTNTS/ FOOTANG,G,IA,IB,IC,ID,IE,IF,IG,K1,K2,K3,K4,K5,K6,
     &K7,K8,L1,L10,L11,L12,L2,L3,L4,L5,L6,L7,L8,L9,MA,MB,MC,MD,ME,MF,MG,
     &MTPB,MTPK
      COMMON/VARIBLES/ Q1,Q2,Q3,Q4,Q5,Q6,Q7,U1,U2,U3,U4,U5,U6,U7
      COMMON/ALGBRAIC/ AANG,AANGVEL,AETOR,AFTOR,ATOR,COP,GRF,HANG,HANGVE
     &L,HETOR,HFTOR,HTOR,HZ,KANG,KANGVEL,KECM,KETOR,KFTOR,KTOR,MANG,MANG
     &VEL,METOR,MFTOR,MTOR,PECM,PX,PY,RX,RX1,RX2,RY,RY1,RY2,SHANG,SHANGV
     &EL,SHTOR,SKANG,SKANGVEL,SKTOR,TE,U8,U9,Q1p,Q2p,Q3p,Q4p,Q5p,Q6p,Q7p
     &,U1p,U2p,U3p,U4p,U5p,U6p,U7p,AEACT,AECCANG,AECCANGVEL,AESECANG,AES
     &ECANGVEL,AFACT,AFCCANG,AFCCANGVEL,AFSECANG,AFSECANGVEL,EA,FA,GS,HE
     &ACT,HECCANG,HECCANGVEL,HESECANG,HESECANGVEL,HFACT,HFCCANG,HFCCANGV
     &EL,HFSECANG,HFSECANGVEL,KEACT,KECCANG,KECCANGVEL,KESECANG,KESECANG
     &VEL,KFACT,KFCCANG,KFCCANGVEL,KFSECANG,KFSECANGVEL,MEACT,MECCANG,ME
     &CCANGVEL,MESECANG,MESECANGVEL,MFACT,MFCCANG,MFCCANGVEL,MFSECANG,MF
     &SECANGVEL,EAp,FAp,GSp,EApp,FApp,GSpp,MT,POCMSTANCEX,POCMSTANCEY,PO
     &CMSWINGX,POCMSWINGY,POCMX,POCMY,POGOX,POGOY,POP1X,POP1Y,POP2X,POP2
     &Y,POP3X,POP3Y,POP4X,POP4Y,POP5X,POP5Y,POP6X,POP6Y,POP7X,POP7Y,POP8
     &X,POP8Y,POP9X,POP9Y,PSTANCEX,PSTANCEY,PSWINGX,PSWINGY,VOCMSTANCEX,
     &VOCMSTANCEY,VOCMSWINGX,VOCMSWINGY,VOCMX,VOCMY,VOP2X,VOP2Y
      COMMON/MISCLLNS/ PI,DEGtoRAD,RADtoDEG,COEF(7,7),RHS(7)

C**   Evaluate output quantities
      RX = RX1 + RX2
      RY = RY1 + RY2
      GRF = (RX**2+RY**2)**0.5D0
      COP = (Q1*RY1+RY2*POP2X)/GRF
      KECM = 0.5D0*IG*U3**2 + 0.5D0*ID*(U3-U7)**2 + 0.5D0*IC*(U3-U6-U7)*
     &*2 + 0.5D0*IE*(EAp-U3-U8)**2 + 0.5D0*IB*(U3-U5-U6-U7)**2 + 0.5D0*I
     &A*(U3-U4-U5-U6-U7)**2 + 0.5D0*IF*(EAp-FAp-U3-U8-U9)**2 + 0.5D0*MA*
     &(U1**2+U2**2+L1**2*(U3-U4-U5-U6-U7)**2+2*L1*SIN(Q3-Q4-Q5-Q6-Q7)*U1
     &*(U3-U4-U5-U6-U7)-2*L1*COS(Q3-Q4-Q5-Q6-Q7)*U2*(U3-U4-U5-U6-U7)) + 
     &0.5D0*MC*(U1**2+U2**2+L7**2*(U3-U6-U7)**2+L6**2*(U3-U5-U6-U7)**2+L
     &2**2*(U3-U4-U5-U6-U7)**2+2*L7*COS(Q3-Q6-Q7)*U2*(U3-U6-U7)+2*L6*COS
     &(Q3-Q5-Q6-Q7)*U2*(U3-U5-U6-U7)+2*L6*L7*COS(Q5)*(U3-U6-U7)*(U3-U5-U
     &6-U7)+2*L2*SIN(Q3-Q4-Q5-Q6-Q7)*U1*(U3-U4-U5-U6-U7)-2*L7*SIN(Q3-Q6-
     &Q7)*U1*(U3-U6-U7)-2*L6*SIN(Q3-Q5-Q6-Q7)*U1*(U3-U5-U6-U7)-2*L2*L7*C
     &OS(Q4+Q5)*(U3-U6-U7)*(U3-U4-U5-U6-U7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)*U2*
     &(U3-U4-U5-U6-U7)-2*L2*L6*COS(Q4)*(U3-U5-U6-U7)*(U3-U4-U5-U6-U7)) +
     & 0.125D0*MB*(4*U1**2+4*U2**2+L3**2*(U3-U5-U6-U7)**2+L4**2*(U3-U5-U
     &6-U7)**2+4*L2**2*(U3-U4-U5-U6-U7)**2+2*L3*L4*COS(FOOTANG)*(U3-U5-U
     &6-U7)**2+4*L4*COS(Q3-Q5-Q6-Q7)*U2*(U3-U5-U6-U7)+4*L3*COS(FOOTANG+Q
     &3-Q5-Q6-Q7)*U2*(U3-U5-U6-U7)+8*L2*SIN(Q3-Q4-Q5-Q6-Q7)*U1*(U3-U4-U5
     &-U6-U7)-4*L4*SIN(Q3-Q5-Q6-Q7)*U1*(U3-U5-U6-U7)-4*L3*SIN(FOOTANG+Q3
     &-Q5-Q6-Q7)*U1*(U3-U5-U6-U7)-8*L2*COS(Q3-Q4-Q5-Q6-Q7)*U2*(U3-U4-U5-
     &U6-U7)-4*L2*L4*COS(Q4)*(U3-U5-U6-U7)*(U3-U4-U5-U6-U7)-4*L2*L3*COS(
     &FOOTANG+Q4)*(U3-U5-U6-U7)*(U3-U4-U5-U6-U7)) + 0.5D0*MD*(U1**2+U2**
     &2+L9**2*(U3-U7)**2+L8**2*(U3-U6-U7)**2+L6**2*(U3-U5-U6-U7)**2+2*L9
     &*COS(Q3-Q7)*U2*(U3-U7)+L2**2*(U3-U4-U5-U6-U7)**2+2*L8*COS(Q3-Q6-Q7
     &)*U2*(U3-U6-U7)+2*L8*L9*COS(Q6)*(U3-U7)*(U3-U6-U7)+2*L6*L9*COS(Q5+
     &Q6)*(U3-U7)*(U3-U5-U6-U7)+2*L6*COS(Q3-Q5-Q6-Q7)*U2*(U3-U5-U6-U7)+2
     &*L6*L8*COS(Q5)*(U3-U6-U7)*(U3-U5-U6-U7)+2*L2*SIN(Q3-Q4-Q5-Q6-Q7)*U
     &1*(U3-U4-U5-U6-U7)-2*L9*SIN(Q3-Q7)*U1*(U3-U7)-2*L8*SIN(Q3-Q6-Q7)*U
     &1*(U3-U6-U7)-2*L6*SIN(Q3-Q5-Q6-Q7)*U1*(U3-U5-U6-U7)-2*L2*L9*COS(Q4
     &+Q5+Q6)*(U3-U7)*(U3-U4-U5-U6-U7)-2*L2*L8*COS(Q4+Q5)*(U3-U6-U7)*(U3
     &-U4-U5-U6-U7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)*U2*(U3-U4-U5-U6-U7)-2*L2*L6
     &*COS(Q4)*(U3-U5-U6-U7)*(U3-U4-U5-U6-U7)) + 0.5D0*MG*(GSp**2+U1**2+
     &U2**2+GS**2*U3**2+2*GSp*SIN(Q3)*U2+2*GSp*COS(Q3)*U1+2*GS*COS(Q3)*U
     &2*U3+L10**2*(U3-U7)**2+L8**2*(U3-U6-U7)**2+2*L10*GSp*SIN(Q7)*(U3-U
     &7)+2*L10*GS*COS(Q7)*U3*(U3-U7)+L6**2*(U3-U5-U6-U7)**2+2*L10*COS(Q3
     &-Q7)*U2*(U3-U7)+2*L8*GSp*SIN(Q6+Q7)*(U3-U6-U7)+L2**2*(U3-U4-U5-U6-
     &U7)**2+2*L8*GS*COS(Q6+Q7)*U3*(U3-U6-U7)+2*L10*L8*COS(Q6)*(U3-U7)*(
     &U3-U6-U7)+2*L6*GSp*SIN(Q5+Q6+Q7)*(U3-U5-U6-U7)+2*L8*COS(Q3-Q6-Q7)*
     &U2*(U3-U6-U7)+2*L6*GS*COS(Q5+Q6+Q7)*U3*(U3-U5-U6-U7)+2*L10*L6*COS(
     &Q5+Q6)*(U3-U7)*(U3-U5-U6-U7)+2*L6*COS(Q3-Q5-Q6-Q7)*U2*(U3-U5-U6-U7
     &)+2*L6*L8*COS(Q5)*(U3-U6-U7)*(U3-U5-U6-U7)+2*L2*SIN(Q3-Q4-Q5-Q6-Q7
     &)*U1*(U3-U4-U5-U6-U7)-2*GS*SIN(Q3)*U1*U3-2*L10*SIN(Q3-Q7)*U1*(U3-U
     &7)-2*L8*SIN(Q3-Q6-Q7)*U1*(U3-U6-U7)-2*L2*GSp*SIN(Q4+Q5+Q6+Q7)*(U3-
     &U4-U5-U6-U7)-2*L2*GS*COS(Q4+Q5+Q6+Q7)*U3*(U3-U4-U5-U6-U7)-2*L6*SIN
     &(Q3-Q5-Q6-Q7)*U1*(U3-U5-U6-U7)-2*L10*L2*COS(Q4+Q5+Q6)*(U3-U7)*(U3-
     &U4-U5-U6-U7)-2*L2*L8*COS(Q4+Q5)*(U3-U6-U7)*(U3-U4-U5-U6-U7)-2*L2*C
     &OS(Q3-Q4-Q5-Q6-Q7)*U2*(U3-U4-U5-U6-U7)-2*L2*L6*COS(Q4)*(U3-U5-U6-U
     &7)*(U3-U4-U5-U6-U7)) + 0.5D0*MF*(U1**2+U2**2+L10**2*(U3-U7)**2+L10
     &**2*(EAp-U3-U8)**2+L8**2*(U3-U6-U7)**2+L6**2*(U3-U5-U6-U7)**2+2*L1
     &0*COS(Q3-Q7)*U2*(U3-U7)+L12**2*(EAp-FAp-U3-U8-U9)**2+L2**2*(U3-U4-
     &U5-U6-U7)**2+2*L10*L8*COS(Q6)*(U3-U7)*(U3-U6-U7)+2*L8*COS(Q3-Q6-Q7
     &)*U2*(U3-U6-U7)+2*L10*L6*COS(Q5+Q6)*(U3-U7)*(U3-U5-U6-U7)+2*L12*SI
     &N(EA-FA-Q3)*U1*(EAp-FAp-U3-U8-U9)+2*L12*COS(EA-FA-Q3)*U2*(EAp-FAp-
     &U3-U8-U9)+2*L6*COS(Q3-Q5-Q6-Q7)*U2*(U3-U5-U6-U7)+2*L6*L8*COS(Q5)*(
     &U3-U6-U7)*(U3-U5-U6-U7)+2*L10*L12*COS(EA-FA-Q7)*(U3-U7)*(EAp-FAp-U
     &3-U8-U9)+2*L2*SIN(Q3-Q4-Q5-Q6-Q7)*U1*(U3-U4-U5-U6-U7)+2*L12*L8*COS
     &(EA-FA-Q6-Q7)*(U3-U6-U7)*(EAp-FAp-U3-U8-U9)+2*L10*L2*COS(EA-Q4-Q5-
     &Q6-Q7)*(EAp-U3-U8)*(U3-U4-U5-U6-U7)+2*L12*L6*COS(EA-FA-Q5-Q6-Q7)*(
     &U3-U5-U6-U7)*(EAp-FAp-U3-U8-U9)-2*L10*SIN(Q3-Q7)*U1*(U3-U7)-2*L10*
     &SIN(EA-Q3)*U1*(EAp-U3-U8)-2*L10*COS(EA-Q3)*U2*(EAp-U3-U8)-2*L8*SIN
     &(Q3-Q6-Q7)*U1*(U3-U6-U7)-2*L10**2*COS(EA-Q7)*(U3-U7)*(EAp-U3-U8)-2
     &*L6*SIN(Q3-Q5-Q6-Q7)*U1*(U3-U5-U6-U7)-2*L10*L12*COS(FA)*(EAp-U3-U8
     &)*(EAp-FAp-U3-U8-U9)-2*L10*L2*COS(Q4+Q5+Q6)*(U3-U7)*(U3-U4-U5-U6-U
     &7)-2*L10*L8*COS(EA-Q6-Q7)*(EAp-U3-U8)*(U3-U6-U7)-2*L2*L8*COS(Q4+Q5
     &)*(U3-U6-U7)*(U3-U4-U5-U6-U7)-2*L2*COS(Q3-Q4-Q5-Q6-Q7)*U2*(U3-U4-U
     &5-U6-U7)-2*L2*L6*COS(Q4)*(U3-U5-U6-U7)*(U3-U4-U5-U6-U7)-2*L10*L6*C
     &OS(EA-Q5-Q6-Q7)*(EAp-U3-U8)*(U3-U5-U6-U7)-2*L12*L2*COS(EA-FA-Q4-Q5
     &-Q6-Q7)*(EAp-FAp-U3-U8-U9)*(U3-U4-U5-U6-U7)) - 0.5D0*ME*(2*L10*SIN
     &(Q3-Q7)*U1*(U3-U7)+2*L8*SIN(Q3-Q6-Q7)*U1*(U3-U6-U7)+2*(L10-L9)*SIN
     &(EA-Q3)*U1*(EAp-U3-U8)+2*(L10-L9)*COS(EA-Q3)*U2*(EAp-U3-U8)+2*L6*S
     &IN(Q3-Q5-Q6-Q7)*U1*(U3-U5-U6-U7)+2*L10*(L10-L9)*COS(EA-Q7)*(U3-U7)
     &*(EAp-U3-U8)+2*L10*L2*COS(Q4+Q5+Q6)*(U3-U7)*(U3-U4-U5-U6-U7)+2*L2*
     &L8*COS(Q4+Q5)*(U3-U6-U7)*(U3-U4-U5-U6-U7)+2*L2*COS(Q3-Q4-Q5-Q6-Q7)
     &*U2*(U3-U4-U5-U6-U7)+2*L2*L6*COS(Q4)*(U3-U5-U6-U7)*(U3-U4-U5-U6-U7
     &)+2*L8*(L10-L9)*COS(EA-Q6-Q7)*(EAp-U3-U8)*(U3-U6-U7)+2*L6*(L10-L9)
     &*COS(EA-Q5-Q6-Q7)*(EAp-U3-U8)*(U3-U5-U6-U7)-U1**2-U2**2-L10**2*(U3
     &-U7)**2-L8**2*(U3-U6-U7)**2-2*L10*COS(Q3-Q7)*U2*(U3-U7)-L6**2*(U3-
     &U5-U6-U7)**2-(L10-L9)**2*(EAp-U3-U8)**2-L2**2*(U3-U4-U5-U6-U7)**2-
     &2*L10*L8*COS(Q6)*(U3-U7)*(U3-U6-U7)-2*L8*COS(Q3-Q6-Q7)*U2*(U3-U6-U
     &7)-2*L10*L6*COS(Q5+Q6)*(U3-U7)*(U3-U5-U6-U7)-2*L6*COS(Q3-Q5-Q6-Q7)
     &*U2*(U3-U5-U6-U7)-2*L6*L8*COS(Q5)*(U3-U6-U7)*(U3-U5-U6-U7)-2*L2*SI
     &N(Q3-Q4-Q5-Q6-Q7)*U1*(U3-U4-U5-U6-U7)-2*L2*(L10-L9)*COS(EA-Q4-Q5-Q
     &6-Q7)*(EAp-U3-U8)*(U3-U4-U5-U6-U7))
      POCMY = Q2 - 0.5D0*(2*(L10*MF+ME*(L10-L9))*SIN(EA-Q3)+2*(L1*MA+L2*
     &MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)*SIN(Q3-Q4-Q5-Q6-Q7)-2*MG*GS*SIN(
     &Q3)-2*L12*MF*SIN(EA-FA-Q3)-L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)-2*(L10*M
     &E+L10*MF+L10*MG+L9*MD)*SIN(Q3-Q7)-2*(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG
     &)*SIN(Q3-Q6-Q7)-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)*SI
     &N(Q3-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG)
      PECM = 0.5D0*K1*Q1**2 + 0.5D0*K3*Q2**2 - G*MT*POCMY
      TE = KECM + PECM
      HZ = IA*U3 + IB*U3 + IC*U3 + ID*U3 + IE*U3 + IF*U3 + IG*U3 + 0.5D0
     &*L1*MA*(2*L1-(2*L1*MA+2*L2*MB+2*L2*MC+2*L2*MD+2*L2*ME+2*L2*MF+2*L2
     &*MG+2*L12*MF*COS(EA-FA-Q4-Q5-Q6-Q7)-L3*MB*COS(FOOTANG+Q4)-2*MG*GS*
     &COS(Q4+Q5+Q6+Q7)-2*(L10*ME+L10*MF+L10*MG+L9*MD)*COS(Q4+Q5+Q6)-2*(L
     &7*MC+L8*MD+L8*ME+L8*MF+L8*MG)*COS(Q4+Q5)-2*(L10*MF+ME*(L10-L9))*CO
     &S(EA-Q4-Q5-Q6-Q7)-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)*
     &COS(Q4))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U4-U5-U6-U7) + 0.5D0*L2*MB*(2
     &*L2-L3*(1-MB/(MA+MB+MC+MD+ME+MF+MG))*COS(FOOTANG+Q4)-(L4-(L4*MB+2*
     &L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS
     &(Q4)-2*(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG+L12*MF*COS(EA-FA
     &-Q4-Q5-Q6-Q7)-MG*GS*COS(Q4+Q5+Q6+Q7)-(L10*ME+L10*MF+L10*MG+L9*MD)*
     &COS(Q4+Q5+Q6)-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)*COS(Q4+Q5)-(L10*MF+M
     &E*(L10-L9))*COS(EA-Q4-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U4-U5
     &-U6-U7) + 0.5D0*L2*MC*(2*L2-2*(L7-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/
     &(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*
     &L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4)-(2*L1*MA+2*
     &L2*MB+2*L2*MC+2*L2*MD+2*L2*ME+2*L2*MF+2*L2*MG+2*L12*MF*COS(EA-FA-Q
     &4-Q5-Q6-Q7)-L3*MB*COS(FOOTANG+Q4)-2*MG*GS*COS(Q4+Q5+Q6+Q7)-2*(L10*
     &ME+L10*MF+L10*MG+L9*MD)*COS(Q4+Q5+Q6)-2*(L10*MF+ME*(L10-L9))*COS(E
     &A-Q4-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U4-U5-U6-U7) + 0.5D0*L
     &6*ME*(2*L6+2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+
     &MG))*COS(Q5+Q6)+2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD
     &+ME+MF+MG))*COS(Q5)+2*(L10-L9-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+ME
     &+MF+MG))*COS(EA-Q5-Q6-Q7)-2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*
     &MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4)-(L4*MB+2*L6*MC+2*L6*MD+2
     &*L6*ME+2*L6*MF+2*L6*MG+L3*MB*COS(FOOTANG)+2*MG*GS*COS(Q5+Q6+Q7)-2*
     &L12*MF*COS(EA-FA-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U5-U6-U7) 
     &+ 0.5D0*L8*ME*(2*L8+2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+
     &MD+ME+MF+MG))*COS(Q6)+2*(L10-L9-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+
     &ME+MF+MG))*COS(EA-Q6-Q7)+(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6
     &*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5)-2*(L2-(L1*MA+L2*MB+L2
     &*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5)-(2
     &*L7*MC+2*L8*MD+2*L8*ME+2*L8*MF+2*L8*MG+2*MG*GS*COS(Q6+Q7)+L3*MB*CO
     &S(FOOTANG-Q5)-2*L12*MF*COS(EA-FA-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(
     &U3-U6-U7) + 0.5D0*L2*MD*(2*L2-2*(L9-(L10*ME+L10*MF+L10*MG+L9*MD)/(
     &MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5+Q6)-2*(L8-(L7*MC+L8*MD+L8*ME+L8*M
     &F+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5)-(2*L6-(L4*MB+2*L6*MC+2
     &*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4)-(2
     &*L1*MA+2*L2*MB+2*L2*MC+2*L2*MD+2*L2*ME+2*L2*MF+2*L2*MG+2*L12*MF*CO
     &S(EA-FA-Q4-Q5-Q6-Q7)-L3*MB*COS(FOOTANG+Q4)-2*MG*GS*COS(Q4+Q5+Q6+Q7
     &)-2*(L10*MF+ME*(L10-L9))*COS(EA-Q4-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+M
     &G))*(U3-U4-U5-U6-U7) + 0.5D0*L10*MF*(2*L10+2*(L10-(L10*MF+ME*(L10-
     &L9))/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q7)+2*(L8-(L7*MC+L8*MD+L8*ME+L
     &8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q6)+(2*L6-(L4*MB+2*L6*MC+2
     &*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5+Q6)
     &-2*L12*(1-MF/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-Q7)-2*(L2-(L1*MA+L2
     &*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+
     &Q5+Q6)-(2*L10*ME+2*L10*MF+2*L10*MG+2*L9*MD+2*MG*GS*COS(Q7)+L3*MB*C
     &OS(FOOTANG-Q5-Q6))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U7) + 0.5D0*L6*MF*(
     &2*L6+2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*C
     &OS(Q5+Q6)+2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF
     &+MG))*COS(Q5)+2*(L10-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+ME+MF+MG))*
     &COS(EA-Q5-Q6-Q7)-2*L12*(1-MF/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-Q5-
     &Q6-Q7)-2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC
     &+MD+ME+MF+MG))*COS(Q4)-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6
     &*MG+L3*MB*COS(FOOTANG)+2*MG*GS*COS(Q5+Q6+Q7))/(MA+MB+MC+MD+ME+MF+M
     &G))*(U3-U5-U6-U7) + 0.5D0*L8*MF*(2*L8+2*(L10-(L10*ME+L10*MF+L10*MG
     &+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q6)+2*(L10-(L10*MF+ME*(L10-L9)
     &)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q6-Q7)+(2*L6-(L4*MB+2*L6*MC+2*L6*
     &MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5)-2*L12*
     &(1-MF/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-Q6-Q7)-2*(L2-(L1*MA+L2*MB+
     &L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5)-
     &(2*L7*MC+2*L8*MD+2*L8*ME+2*L8*MF+2*L8*MG+2*MG*GS*COS(Q6+Q7)+L3*MB*
     &COS(FOOTANG-Q5))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U6-U7) + 0.5D0*ME*(L1
     &0-L9)*(2*L9+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+
     &MB+MC+MD+ME+MF+MG))*COS(EA-Q4-Q5-Q6-Q7)-2*L10-2*(L10-(L10*ME+L10*M
     &F+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q7)-2*(L8-(L7*MC+L8
     &*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q6-Q7)-(2*L6
     &-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+M
     &F+MG))*COS(EA-Q5-Q6-Q7)-(2*L12*MF*COS(FA)-2*L10*MF-2*ME*(L10-L9)-2
     &*MG*GS*COS(EA)-L3*MB*COS(FOOTANG+EA-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+
     &MG))*(EAp-U3-U8) + 0.5D0*L2*MG*(2*L2-2*(1-MG/(MA+MB+MC+MD+ME+MF+MG
     &))*GS*COS(Q4+Q5+Q6+Q7)-2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+
     &MC+MD+ME+MF+MG))*COS(Q4+Q5+Q6)-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*M
     &G)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD
     &+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4)-(2*L1*MA
     &+2*L2*MB+2*L2*MC+2*L2*MD+2*L2*ME+2*L2*MF+2*L2*MG+2*L12*MF*COS(EA-F
     &A-Q4-Q5-Q6-Q7)-L3*MB*COS(FOOTANG+Q4)-2*(L10*MF+ME*(L10-L9))*COS(EA
     &-Q4-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U4-U5-U6-U7) + 0.5D0*L1
     &0*MF*(2*L12*(1-MF/(MA+MB+MC+MD+ME+MF+MG))*COS(FA)+(2*L10*MF+2*ME*(
     &L10-L9)+2*MG*GS*COS(EA)+L3*MB*COS(FOOTANG+EA-Q5-Q6-Q7))/(MA+MB+MC+
     &MD+ME+MF+MG)+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA
     &+MB+MC+MD+ME+MF+MG))*COS(EA-Q4-Q5-Q6-Q7)-2*L10-2*(L10-(L10*ME+L10*
     &MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q7)-2*(L8-(L7*MC+L
     &8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q6-Q7)-(2*L
     &6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+
     &MF+MG))*COS(EA-Q5-Q6-Q7))*(EAp-U3-U8) + 0.5D0*L2*MF*(2*L2+2*L12*(1
     &-MF/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-Q4-Q5-Q6-Q7)-2*(L10-(L10*ME+
     &L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5+Q6)-2*(L8-(
     &L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5)-
     &2*(L10-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q4-Q5-Q
     &6-Q7)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB
     &+MC+MD+ME+MF+MG))*COS(Q4)-(2*L1*MA+2*L2*MB+2*L2*MC+2*L2*MD+2*L2*ME
     &+2*L2*MF+2*L2*MG-L3*MB*COS(FOOTANG+Q4)-2*MG*GS*COS(Q4+Q5+Q6+Q7))/(
     &MA+MB+MC+MD+ME+MF+MG))*(U3-U4-U5-U6-U7) - ID*U7 - IC*(U6+U7) - IB*
     &(U5+U6+U7) - IE*(EAp-U8) - IA*(U4+U5+U6+U7) - IF*(EAp-FAp-U8-U9) -
     & 0.5D0*L6*MC*(2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(M
     &A+MB+MC+MD+ME+MF+MG))*COS(Q4)-2*L6-2*(L7-(L7*MC+L8*MD+L8*ME+L8*MF+
     &L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5)-(2*L12*MF*COS(EA-FA-Q5-Q6-Q
     &7)-2*L6*MC-2*L6*MD-2*L6*ME-2*L6*MF-2*L6*MG-L4*MB-L3*MB*COS(FOOTANG
     &)-2*MG*GS*COS(Q5+Q6+Q7)-2*(L10*ME+L10*MF+L10*MG+L9*MD)*COS(Q5+Q6)-
     &2*(L10*MF+ME*(L10-L9))*COS(EA-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(
     &U3-U5-U6-U7) - 0.5D0*L7*MC*(2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L
     &2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5)-2*L7-(2*L6-(L4*MB+2
     &*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*CO
     &S(Q5)-(2*L12*MF*COS(EA-FA-Q6-Q7)-2*L7*MC-2*L8*MD-2*L8*ME-2*L8*MF-2
     &*L8*MG-2*MG*GS*COS(Q6+Q7)-L3*MB*COS(FOOTANG-Q5)-2*(L10*ME+L10*MF+L
     &10*MG+L9*MD)*COS(Q6)-2*(L10*MF+ME*(L10-L9))*COS(EA-Q6-Q7))/(MA+MB+
     &MC+MD+ME+MF+MG))*(U3-U6-U7) - 0.25D0*L4*MB*(2*(L2-(L1*MA+L2*MB+L2*
     &MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4)-L4-L3*
     &COS(FOOTANG)*(1-MB/(MA+MB+MC+MD+ME+MF+MG))-(2*L12*MF*COS(EA-FA-Q5-
     &Q6-Q7)-2*L6*MC-2*L6*MD-2*L6*ME-2*L6*MF-2*L6*MG-L4*MB-2*MG*GS*COS(Q
     &5+Q6+Q7)-2*(L10*ME+L10*MF+L10*MG+L9*MD)*COS(Q5+Q6)-2*(L7*MC+L8*MD+
     &L8*ME+L8*MF+L8*MG)*COS(Q5)-2*(L10*MF+ME*(L10-L9))*COS(EA-Q5-Q6-Q7)
     &)/(MA+MB+MC+MD+ME+MF+MG))*(U3-U5-U6-U7) - 0.5D0*L9*MD*(2*(L2-(L1*M
     &A+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS
     &(Q4+Q5+Q6)-2*L9-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD
     &+ME+MF+MG))*COS(Q6)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2
     &*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5+Q6)-(2*L12*MF*COS(EA-FA-Q7)
     &-2*L10*ME-2*L10*MF-2*L10*MG-2*L9*MD-2*MG*GS*COS(Q7)-L3*MB*COS(FOOT
     &ANG-Q5-Q6)-2*(L10*MF+ME*(L10-L9))*COS(EA-Q7))/(MA+MB+MC+MD+ME+MF+M
     &G))*(U3-U7) - 0.5D0*L6*MD*(2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2
     &*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4)-2*L6-2*(L9-(L10*ME+L10*
     &MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5+Q6)-2*(L8-(L7*MC+L
     &8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5)-(2*L12*MF*
     &COS(EA-FA-Q5-Q6-Q7)-2*L6*MC-2*L6*MD-2*L6*ME-2*L6*MF-2*L6*MG-L4*MB-
     &L3*MB*COS(FOOTANG)-2*MG*GS*COS(Q5+Q6+Q7)-2*(L10*MF+ME*(L10-L9))*CO
     &S(EA-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U5-U6-U7) - 0.5D0*L8*M
     &D*(2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+
     &ME+MF+MG))*COS(Q4+Q5)-2*L8-2*(L9-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+
     &MB+MC+MD+ME+MF+MG))*COS(Q6)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2
     &*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5)-(2*L12*MF*COS(EA-F
     &A-Q6-Q7)-2*L7*MC-2*L8*MD-2*L8*ME-2*L8*MF-2*L8*MG-2*MG*GS*COS(Q6+Q7
     &)-L3*MB*COS(FOOTANG-Q5)-2*(L10*MF+ME*(L10-L9))*COS(EA-Q6-Q7))/(MA+
     &MB+MC+MD+ME+MF+MG))*(U3-U6-U7) - 0.5D0*L10*MG*(2*(L2-(L1*MA+L2*MB+
     &L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5+Q
     &6)-2*L10-2*(1-MG/(MA+MB+MC+MD+ME+MF+MG))*GS*COS(Q7)-2*(L8-(L7*MC+L
     &8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q6)-(2*L6-(L4*
     &MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG)
     &)*COS(Q5+Q6)-(2*L12*MF*COS(EA-FA-Q7)-2*L10*ME-2*L10*MF-2*L10*MG-2*
     &L9*MD-L3*MB*COS(FOOTANG-Q5-Q6)-2*(L10*MF+ME*(L10-L9))*COS(EA-Q7))/
     &(MA+MB+MC+MD+ME+MF+MG))*(U3-U7) - 0.5D0*L10*ME*(2*(L2-(L1*MA+L2*MB
     &+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4+Q5+
     &Q6)-2*L10-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF
     &+MG))*COS(Q6)-2*(L10-L9-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+ME+MF+MG
     &))*COS(EA-Q7)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG
     &)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q5+Q6)-(2*L12*MF*COS(EA-FA-Q7)-2*L10
     &*ME-2*L10*MF-2*L10*MG-2*L9*MD-2*MG*GS*COS(Q7)-L3*MB*COS(FOOTANG-Q5
     &-Q6))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U7) - 0.25D0*L3*MB*(2*(L2-(L1*MA
     &+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(
     &FOOTANG+Q4)-L3*(1-MB/(MA+MB+MC+MD+ME+MF+MG))-COS(FOOTANG)*(L4-(L4*
     &MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG)
     &)-2*(L12*MF*COS(FOOTANG+EA-FA-Q5-Q6-Q7)-MG*GS*COS(FOOTANG-Q5-Q6-Q7
     &)-(L10*ME+L10*MF+L10*MG+L9*MD)*COS(FOOTANG-Q5-Q6)-(L7*MC+L8*MD+L8*
     &ME+L8*MF+L8*MG)*COS(FOOTANG-Q5)-(L10*MF+ME*(L10-L9))*COS(FOOTANG+E
     &A-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U5-U6-U7) - 0.5D0*L6*MG*(
     &2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+
     &MF+MG))*COS(Q4)-2*L6-2*(1-MG/(MA+MB+MC+MD+ME+MF+MG))*GS*COS(Q5+Q6+
     &Q7)-2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*CO
     &S(Q5+Q6)-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+
     &MG))*COS(Q5)-(2*L12*MF*COS(EA-FA-Q5-Q6-Q7)-2*L6*MC-2*L6*MD-2*L6*ME
     &-2*L6*MF-2*L6*MG-L4*MB-L3*MB*COS(FOOTANG)-2*(L10*MF+ME*(L10-L9))*C
     &OS(EA-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U5-U6-U7) - 0.5D0*L8*
     &MG*(2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD
     &+ME+MF+MG))*COS(Q4+Q5)-2*L8-2*(1-MG/(MA+MB+MC+MD+ME+MF+MG))*GS*COS
     &(Q6+Q7)-2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG)
     &)*COS(Q6)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(M
     &A+MB+MC+MD+ME+MF+MG))*COS(Q5)-(2*L12*MF*COS(EA-FA-Q6-Q7)-2*L7*MC-2
     &*L8*MD-2*L8*ME-2*L8*MF-2*L8*MG-L3*MB*COS(FOOTANG-Q5)-2*(L10*MF+ME*
     &(L10-L9))*COS(EA-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG))*(U3-U6-U7) - 0.5D
     &0*L2*ME*(2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG
     &))*COS(Q4+Q5+Q6)+2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+M
     &D+ME+MF+MG))*COS(Q4+Q5)+(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*
     &MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q4)+2*(L10-L9-(L10*MF+ME*(
     &L10-L9))/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-Q4-Q5-Q6-Q7)-2*L2-(L3*MB*C
     &OS(FOOTANG+Q4)+2*MG*GS*COS(Q4+Q5+Q6+Q7)-2*L1*MA-2*L2*MB-2*L2*MC-2*
     &L2*MD-2*L2*ME-2*L2*MF-2*L2*MG-2*L12*MF*COS(EA-FA-Q4-Q5-Q6-Q7))/(MA
     &+MB+MC+MD+ME+MF+MG))*(U3-U4-U5-U6-U7) - 0.5D0*L12*MF*(2*L12*(1-MF/
     &(MA+MB+MC+MD+ME+MF+MG))+(2*MG*GS*COS(EA-FA)+L3*MB*COS(FOOTANG+EA-F
     &A-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG)+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD
     &+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-Q4-Q5-Q6-Q7)
     &-2*(L10-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+ME+MF+MG))*COS(FA)-2*(L1
     &0-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-Q
     &7)-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*C
     &OS(EA-FA-Q6-Q7)-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*
     &MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-Q5-Q6-Q7))*(EAp-FAp-U3-U8-U9
     &) - 0.5D0*MA*(2*(L1-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(M
     &A+MB+MC+MD+ME+MF+MG))*COS(Q3-Q4-Q5-Q6-Q7)*U2-2*(L1-(L1*MA+L2*MB+L2
     &*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q4-Q5-
     &Q6-Q7)*U1-(2*MG*GS*SIN(Q3)*U1+2*L12*MF*SIN(EA-FA-Q3)*U1+2*L12*MF*C
     &OS(EA-FA-Q3)*U2+L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*U1+2*(L10*ME+L10*MF
     &+L10*MG+L9*MD)*SIN(Q3-Q7)*U1+2*(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)*SIN
     &(Q3-Q6-Q7)*U1+(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)*SIN(
     &Q3-Q5-Q6-Q7)*U1-2*MG*GS*COS(Q3)*U2-L3*MB*COS(FOOTANG+Q3-Q5-Q6-Q7)*
     &U2-2*(L10*MF+ME*(L10-L9))*SIN(EA-Q3)*U1-2*(L10*MF+ME*(L10-L9))*COS
     &(EA-Q3)*U2-2*(L10*ME+L10*MF+L10*MG+L9*MD)*COS(Q3-Q7)*U2-2*(L7*MC+L
     &8*MD+L8*ME+L8*MF+L8*MG)*COS(Q3-Q6-Q7)*U2-(L4*MB+2*L6*MC+2*L6*MD+2*
     &L6*ME+2*L6*MF+2*L6*MG)*COS(Q3-Q5-Q6-Q7)*U2)/(MA+MB+MC+MD+ME+MF+MG)
     &) - 0.5D0*MB*(L3*(1-MB/(MA+MB+MC+MD+ME+MF+MG))*SIN(FOOTANG+Q3-Q5-Q
     &6-Q7)*U1+(L4-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+M
     &B+MC+MD+ME+MF+MG))*SIN(Q3-Q5-Q6-Q7)*U1+2*(L2-(L1*MA+L2*MB+L2*MC+L2
     &*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q3-Q4-Q5-Q6-Q7)
     &*U2-L3*(1-MB/(MA+MB+MC+MD+ME+MF+MG))*COS(FOOTANG+Q3-Q5-Q6-Q7)*U2-2
     &*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+M
     &F+MG))*SIN(Q3-Q4-Q5-Q6-Q7)*U1-(L4-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2
     &*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q3-Q5-Q6-Q7)*U2-2*(MG*
     &GS*SIN(Q3)*U1+L12*MF*SIN(EA-FA-Q3)*U1+L12*MF*COS(EA-FA-Q3)*U2+(L10
     &*ME+L10*MF+L10*MG+L9*MD)*SIN(Q3-Q7)*U1+(L7*MC+L8*MD+L8*ME+L8*MF+L8
     &*MG)*SIN(Q3-Q6-Q7)*U1-MG*GS*COS(Q3)*U2-(L10*MF+ME*(L10-L9))*SIN(EA
     &-Q3)*U1-(L10*MF+ME*(L10-L9))*COS(EA-Q3)*U2-(L10*ME+L10*MF+L10*MG+L
     &9*MD)*COS(Q3-Q7)*U2-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)*COS(Q3-Q6-Q7)*
     &U2)/(MA+MB+MC+MD+ME+MF+MG)) - 0.5D0*MG*(2*(L2-(L1*MA+L2*MB+L2*MC+L
     &2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*GSp*SIN(Q4+Q5+Q6+Q
     &7)+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+
     &ME+MF+MG))*GS*COS(Q4+Q5+Q6+Q7)*U3-2*(L10-(L10*ME+L10*MF+L10*MG+L9*
     &MD)/(MA+MB+MC+MD+ME+MF+MG))*GSp*SIN(Q7)-2*(L8-(L7*MC+L8*MD+L8*ME+L
     &8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*GSp*SIN(Q6+Q7)-(2*L6-(L4*MB+2*
     &L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*GSp
     &*SIN(Q5+Q6+Q7)-2*(1-MG/(MA+MB+MC+MD+ME+MF+MG))*GS**2*U3-2*(L10-(L1
     &0*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*GS*COS(Q7)*U3-2*
     &(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*GS*COS
     &(Q6+Q7)*U3-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(
     &MA+MB+MC+MD+ME+MF+MG))*GS*COS(Q5+Q6+Q7)*U3-(2*L12*MF*SIN(EA-FA)*GS
     &p+L3*MB*GSp*SIN(FOOTANG-Q5-Q6-Q7)+2*L12*MF*GS*COS(EA-FA)*U3-2*(L10
     &*MF+ME*(L10-L9))*SIN(EA)*GSp-2*(L10*MF+ME*(L10-L9))*GS*COS(EA)*U3-
     &L3*MB*GS*COS(FOOTANG-Q5-Q6-Q7)*U3)/(MA+MB+MC+MD+ME+MF+MG)) - 0.5D0
     &*MC*(2*(L7-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))
     &*SIN(Q3-Q6-Q7)*U1+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG
     &)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q3-Q4-Q5-Q6-Q7)*U2+(2*L6-(L4*MB+2*L6
     &*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q
     &3-Q5-Q6-Q7)*U1-2*(L7-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+
     &ME+MF+MG))*COS(Q3-Q6-Q7)*U2-2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L
     &2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q4-Q5-Q6-Q7)*U1-(2*L6-(
     &L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+
     &MG))*COS(Q3-Q5-Q6-Q7)*U2-(2*MG*GS*SIN(Q3)*U1+2*L12*MF*SIN(EA-FA-Q3
     &)*U1+2*L12*MF*COS(EA-FA-Q3)*U2+L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*U1+2
     &*(L10*ME+L10*MF+L10*MG+L9*MD)*SIN(Q3-Q7)*U1-2*MG*GS*COS(Q3)*U2-L3*
     &MB*COS(FOOTANG+Q3-Q5-Q6-Q7)*U2-2*(L10*MF+ME*(L10-L9))*SIN(EA-Q3)*U
     &1-2*(L10*MF+ME*(L10-L9))*COS(EA-Q3)*U2-2*(L10*ME+L10*MF+L10*MG+L9*
     &MD)*COS(Q3-Q7)*U2)/(MA+MB+MC+MD+ME+MF+MG)) - 0.5D0*MD*(2*(L9-(L10*
     &ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q7)*U1+2*(L
     &8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q
     &6-Q7)*U1+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+
     &MC+MD+ME+MF+MG))*COS(Q3-Q4-Q5-Q6-Q7)*U2+(2*L6-(L4*MB+2*L6*MC+2*L6*
     &MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q5-Q6-Q
     &7)*U1-2*(L9-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*C
     &OS(Q3-Q7)*U2-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME
     &+MF+MG))*COS(Q3-Q6-Q7)*U2-2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*
     &MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q4-Q5-Q6-Q7)*U1-(2*L6-(L4
     &*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG
     &))*COS(Q3-Q5-Q6-Q7)*U2-(2*MG*GS*SIN(Q3)*U1+2*L12*MF*SIN(EA-FA-Q3)*
     &U1+2*L12*MF*COS(EA-FA-Q3)*U2+L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*U1-2*M
     &G*GS*COS(Q3)*U2-L3*MB*COS(FOOTANG+Q3-Q5-Q6-Q7)*U2-2*(L10*MF+ME*(L1
     &0-L9))*SIN(EA-Q3)*U1-2*(L10*MF+ME*(L10-L9))*COS(EA-Q3)*U2)/(MA+MB+
     &MC+MD+ME+MF+MG)) - 0.5D0*MG*(2*(1-MG/(MA+MB+MC+MD+ME+MF+MG))*GS*SI
     &N(Q3)*U1+2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG
     &))*SIN(Q3-Q7)*U1+2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+M
     &D+ME+MF+MG))*SIN(Q3-Q6-Q7)*U1+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME
     &+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q3-Q4-Q5-Q6-Q7)*U2+(2*L6
     &-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+M
     &F+MG))*SIN(Q3-Q5-Q6-Q7)*U1-2*(1-MG/(MA+MB+MC+MD+ME+MF+MG))*GS*COS(
     &Q3)*U2-2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))
     &*COS(Q3-Q7)*U2-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+
     &ME+MF+MG))*COS(Q3-Q6-Q7)*U2-2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L
     &2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q4-Q5-Q6-Q7)*U1-(2*L6-(
     &L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+
     &MG))*COS(Q3-Q5-Q6-Q7)*U2-(2*L12*MF*SIN(EA-FA-Q3)*U1+2*L12*MF*COS(E
     &A-FA-Q3)*U2+L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*U1-L3*MB*COS(FOOTANG+Q3
     &-Q5-Q6-Q7)*U2-2*(L10*MF+ME*(L10-L9))*SIN(EA-Q3)*U1-2*(L10*MF+ME*(L
     &10-L9))*COS(EA-Q3)*U2)/(MA+MB+MC+MD+ME+MF+MG)) - 0.5D0*ME*(2*(L10-
     &(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q7)*U1
     &+2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN
     &(Q3-Q6-Q7)*U1+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(M
     &A+MB+MC+MD+ME+MF+MG))*COS(Q3-Q4-Q5-Q6-Q7)*U2+(2*L6-(L4*MB+2*L6*MC+
     &2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q5
     &-Q6-Q7)*U1-2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+
     &MG))*COS(Q3-Q7)*U2-2*(L10-L9-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+ME+
     &MF+MG))*SIN(EA-Q3)*U1-2*(L10-L9-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+
     &ME+MF+MG))*COS(EA-Q3)*U2-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA
     &+MB+MC+MD+ME+MF+MG))*COS(Q3-Q6-Q7)*U2-2*(L2-(L1*MA+L2*MB+L2*MC+L2*
     &MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q4-Q5-Q6-Q7)*
     &U1-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC
     &+MD+ME+MF+MG))*COS(Q3-Q5-Q6-Q7)*U2-(2*MG*GS*SIN(Q3)*U1+2*L12*MF*SI
     &N(EA-FA-Q3)*U1+2*L12*MF*COS(EA-FA-Q3)*U2+L3*MB*SIN(FOOTANG+Q3-Q5-Q
     &6-Q7)*U1-2*MG*GS*COS(Q3)*U2-L3*MB*COS(FOOTANG+Q3-Q5-Q6-Q7)*U2)/(MA
     &+MB+MC+MD+ME+MF+MG)) - 0.5D0*MF*(2*L12*(1-MF/(MA+MB+MC+MD+ME+MF+MG
     &))*SIN(EA-FA-Q3)*U1+2*L12*(1-MF/(MA+MB+MC+MD+ME+MF+MG))*COS(EA-FA-
     &Q3)*U2+2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+MB+MC+MD+ME+MF+MG))
     &*SIN(Q3-Q7)*U1+2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)/(MA+MB+MC+MD+
     &ME+MF+MG))*SIN(Q3-Q6-Q7)*U1+2*(L2-(L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L
     &2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q3-Q4-Q5-Q6-Q7)*U2+(2*L6-(
     &L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(MA+MB+MC+MD+ME+MF+
     &MG))*SIN(Q3-Q5-Q6-Q7)*U1-2*(L10-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+
     &ME+MF+MG))*SIN(EA-Q3)*U1-2*(L10-(L10*MF+ME*(L10-L9))/(MA+MB+MC+MD+
     &ME+MF+MG))*COS(EA-Q3)*U2-2*(L10-(L10*ME+L10*MF+L10*MG+L9*MD)/(MA+M
     &B+MC+MD+ME+MF+MG))*COS(Q3-Q7)*U2-2*(L8-(L7*MC+L8*MD+L8*ME+L8*MF+L8
     &*MG)/(MA+MB+MC+MD+ME+MF+MG))*COS(Q3-Q6-Q7)*U2-2*(L2-(L1*MA+L2*MB+L
     &2*MC+L2*MD+L2*ME+L2*MF+L2*MG)/(MA+MB+MC+MD+ME+MF+MG))*SIN(Q3-Q4-Q5
     &-Q6-Q7)*U1-(2*L6-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)/(
     &MA+MB+MC+MD+ME+MF+MG))*COS(Q3-Q5-Q6-Q7)*U2-(2*MG*GS*SIN(Q3)*U1+L3*
     &MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*U1-2*MG*GS*COS(Q3)*U2-L3*MB*COS(FOOTAN
     &G+Q3-Q5-Q6-Q7)*U2)/(MA+MB+MC+MD+ME+MF+MG))
      PX = MG*GSp*COS(Q3) + (MA+MB+MC+MD+ME+MF+MG)*U1 + L12*MF*SIN(EA-FA
     &-Q3)*(EAp-FAp-U3-U8-U9) + (L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*
     &MG)*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7) - MG*GS*SIN(Q3)*U3 - (L10
     &*ME+L10*MF+L10*MG+L9*MD)*SIN(Q3-Q7)*(U3-U7) - (L10*MF+ME*(L10-L9))
     &*SIN(EA-Q3)*(EAp-U3-U8) - 0.5D0*L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*(U3
     &-U5-U6-U7) - (L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)*SIN(Q3-Q6-Q7)*(U3-U6-
     &U7) - 0.5D0*(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)*SIN(Q3
     &-Q5-Q6-Q7)*(U3-U5-U6-U7)
      PY = MG*GSp*SIN(Q3) + MG*GS*COS(Q3)*U3 + (MA+MB+MC+MD+ME+MF+MG)*U2
     & + (L10*ME+L10*MF+L10*MG+L9*MD)*COS(Q3-Q7)*(U3-U7) + L12*MF*COS(EA
     &-FA-Q3)*(EAp-FAp-U3-U8-U9) + 0.5D0*L3*MB*COS(FOOTANG+Q3-Q5-Q6-Q7)*
     &(U3-U5-U6-U7) + (L7*MC+L8*MD+L8*ME+L8*MF+L8*MG)*COS(Q3-Q6-Q7)*(U3-
     &U6-U7) + 0.5D0*(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)*COS
     &(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7) - (L10*MF+ME*(L10-L9))*COS(EA-Q3)*(EAp
     &-U3-U8) - (L1*MA+L2*MB+L2*MC+L2*MD+L2*ME+L2*MF+L2*MG)*COS(Q3-Q4-Q5
     &-Q6-Q7)*(U3-U4-U5-U6-U7)
      HANG = 3.141592653589793D0 + Q7
      KANG = 3.141592653589793D0 - Q6
      AANG = 3.141592653589793D0 + Q5
      HANGVEL = U7
      KANGVEL = -U6
      AANGVEL = U5
      SHANG = EA
      SKANG = FA
      SHANGVEL = EAp
      SKANGVEL = FAp
      METOR = T*MEACT*MECCANG*MECCANGVEL*MESECANG*MESECANGVEL
      MFTOR = T*MFACT*MFCCANG*MFCCANGVEL*MFSECANG*MFSECANGVEL
      SHTOR = IE*EApp + IF*(EApp-FApp) + G*ME*(L10-L9)*COS(EA-Q3) + G*MF
     &*(L10*COS(EA-Q3)-L12*COS(EA-FA-Q3)) + ME*(L10-L9)*((L10-L9)*EApp+L
     &10*SIN(EA-Q7)*(U3-U7)**2+L8*SIN(EA-Q6-Q7)*(U3-U6-U7)**2+L6*SIN(EA-
     &Q5-Q6-Q7)*(U3-U5-U6-U7)**2-L2*SIN(EA-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)
     &**2) + (ME*(L10-L9)*(L6*COS(EA-Q5-Q6-Q7)-L2*COS(EA-Q4-Q5-Q6-Q7))-M
     &F*(L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*L6*COS(EA-FA-Q5-Q6-Q7)-L10*L6*CO
     &S(EA-Q5-Q6-Q7)-L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7)))*U5p + (ME*(L10-L9)*
     &(L8*COS(EA-Q6-Q7)+L6*COS(EA-Q5-Q6-Q7)-L2*COS(EA-Q4-Q5-Q6-Q7))-MF*(
     &L12*L8*COS(EA-FA-Q6-Q7)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*L6*COS(EA-F
     &A-Q5-Q6-Q7)-L10*L8*COS(EA-Q6-Q7)-L10*L6*COS(EA-Q5-Q6-Q7)-L12*L2*CO
     &S(EA-FA-Q4-Q5-Q6-Q7)))*U6p + (ME*(L10-L9)*(L10*COS(EA-Q7)+L8*COS(E
     &A-Q6-Q7)+L6*COS(EA-Q5-Q6-Q7)-L2*COS(EA-Q4-Q5-Q6-Q7))-MF*(L10*L12*C
     &OS(EA-FA-Q7)+L12*L8*COS(EA-FA-Q6-Q7)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L1
     &2*L6*COS(EA-FA-Q5-Q6-Q7)-L10**2*COS(EA-Q7)-L10*L8*COS(EA-Q6-Q7)-L1
     &0*L6*COS(EA-Q5-Q6-Q7)-L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7)))*U7p - MF*(L1
     &0*L12*COS(FA)*EApp+L10*L12*COS(FA)*(EApp-FApp)+L10*L12*SIN(FA)*(EA
     &p-FAp-U3)**2+L10*L12*SIN(EA-FA-Q7)*(U3-U7)**2+L12*L8*SIN(EA-FA-Q6-
     &Q7)*(U3-U6-U7)**2+L12*L6*SIN(EA-FA-Q5-Q6-Q7)*(U3-U5-U6-U7)**2+L10*
     &L2*SIN(EA-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2-L10**2*EApp-L12**2*(EAp
     &p-FApp)-L10*L12*SIN(FA)*(EAp-U3)**2-L10**2*SIN(EA-Q7)*(U3-U7)**2-L
     &10*L8*SIN(EA-Q6-Q7)*(U3-U6-U7)**2-L10*L6*SIN(EA-Q5-Q6-Q7)*(U3-U5-U
     &6-U7)**2-L12*L2*SIN(EA-FA-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) - (ME*
     &(L10-L9)*SIN(EA-Q3)+MF*(L10*SIN(EA-Q3)-L12*SIN(EA-FA-Q3)))*U1p - (
     &ME*(L10-L9)*COS(EA-Q3)+MF*(L10*COS(EA-Q3)-L12*COS(EA-FA-Q3)))*U2p 
     &- L2*(ME*(L10-L9)*COS(EA-Q4-Q5-Q6-Q7)+MF*(L10*COS(EA-Q4-Q5-Q6-Q7)-
     &L12*COS(EA-FA-Q4-Q5-Q6-Q7)))*U4p - (IE+IF+ME*(L10-L9)*(L10+L10*COS
     &(EA-Q7)+L8*COS(EA-Q6-Q7)+L6*COS(EA-Q5-Q6-Q7)-L9-L2*COS(EA-Q4-Q5-Q6
     &-Q7))-MF*(2*L10*L12*COS(FA)+L10*L12*COS(EA-FA-Q7)+L12*L8*COS(EA-FA
     &-Q6-Q7)+L10*L2*COS(EA-Q4-Q5-Q6-Q7)+L12*L6*COS(EA-FA-Q5-Q6-Q7)-L10*
     &*2-L12**2-L10**2*COS(EA-Q7)-L10*L8*COS(EA-Q6-Q7)-L10*L6*COS(EA-Q5-
     &Q6-Q7)-L12*L2*COS(EA-FA-Q4-Q5-Q6-Q7)))*U3p
      SKTOR = G*L12*MF*COS(EA-FA-Q3) + L12*MF*(L10*COS(FA)*EApp+L10*SIN(
     &EA-FA-Q7)*(U3-U7)**2+L8*SIN(EA-FA-Q6-Q7)*(U3-U6-U7)**2+L6*SIN(EA-F
     &A-Q5-Q6-Q7)*(U3-U5-U6-U7)**2-L12*(EApp-FApp)-L10*SIN(FA)*(EAp-U3)*
     &*2-L2*SIN(EA-FA-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7)**2) + L12*MF*(L6*COS
     &(EA-FA-Q5-Q6-Q7)-L2*COS(EA-FA-Q4-Q5-Q6-Q7))*U5p + L12*MF*(L8*COS(E
     &A-FA-Q6-Q7)+L6*COS(EA-FA-Q5-Q6-Q7)-L2*COS(EA-FA-Q4-Q5-Q6-Q7))*U6p 
     &+ L12*MF*(L10*COS(EA-FA-Q7)+L8*COS(EA-FA-Q6-Q7)+L6*COS(EA-FA-Q5-Q6
     &-Q7)-L2*COS(EA-FA-Q4-Q5-Q6-Q7))*U7p + (IF-L12*MF*(L10*COS(FA)+L10*
     &COS(EA-FA-Q7)+L8*COS(EA-FA-Q6-Q7)+L6*COS(EA-FA-Q5-Q6-Q7)-L12-L2*CO
     &S(EA-FA-Q4-Q5-Q6-Q7)))*U3p - IF*(EApp-FApp) - L12*MF*SIN(EA-FA-Q3)
     &*U1p - L12*MF*COS(EA-FA-Q3)*U2p - L12*L2*MF*COS(EA-FA-Q4-Q5-Q6-Q7)
     &*U4p
      POP1X = Q1
      POP1Y = Q2
      POP3X = Q1 + L5*COS(FOOTANG+Q3-Q5-Q6-Q7) - L2*COS(Q3-Q4-Q5-Q6-Q7)
      POP3Y = Q2 + L5*SIN(FOOTANG+Q3-Q5-Q6-Q7) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      POP4X = Q1 + L6*COS(Q3-Q5-Q6-Q7) - L2*COS(Q3-Q4-Q5-Q6-Q7)
      POP4Y = Q2 + L6*SIN(Q3-Q5-Q6-Q7) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      POP5X = Q1 + L8*COS(Q3-Q6-Q7) + L6*COS(Q3-Q5-Q6-Q7) - L2*COS(Q3-Q4
     &-Q5-Q6-Q7)
      POP5Y = Q2 + L8*SIN(Q3-Q6-Q7) + L6*SIN(Q3-Q5-Q6-Q7) - L2*SIN(Q3-Q4
     &-Q5-Q6-Q7)
      POP6X = Q1 + L10*COS(Q3-Q7) + L8*COS(Q3-Q6-Q7) + L6*COS(Q3-Q5-Q6-Q
     &7) - L2*COS(Q3-Q4-Q5-Q6-Q7)
      POP6Y = Q2 + L10*SIN(Q3-Q7) + L8*SIN(Q3-Q6-Q7) + L6*SIN(Q3-Q5-Q6-Q
     &7) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      POP7X = Q1 + L10*COS(EA-Q3) + L10*COS(Q3-Q7) + L8*COS(Q3-Q6-Q7) + 
     &L6*COS(Q3-Q5-Q6-Q7) - L2*COS(Q3-Q4-Q5-Q6-Q7)
      POP7Y = Q2 + L10*SIN(Q3-Q7) + L8*SIN(Q3-Q6-Q7) + L6*SIN(Q3-Q5-Q6-Q
     &7) - L10*SIN(EA-Q3) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      POP8X = Q1 + L10*COS(EA-Q3) + L10*COS(Q3-Q7) + L8*COS(Q3-Q6-Q7) + 
     &L6*COS(Q3-Q5-Q6-Q7) - L8*COS(EA-FA-Q3) - L2*COS(Q3-Q4-Q5-Q6-Q7)
      POP8Y = Q2 + L10*SIN(Q3-Q7) + L8*SIN(EA-FA-Q3) + L8*SIN(Q3-Q6-Q7) 
     &+ L6*SIN(Q3-Q5-Q6-Q7) - L10*SIN(EA-Q3) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      POP9X = Q1 + L11*COS(Q3) + L10*COS(Q3-Q7) + L8*COS(Q3-Q6-Q7) + L6*
     &COS(Q3-Q5-Q6-Q7) - L2*COS(Q3-Q4-Q5-Q6-Q7)
      POP9Y = Q2 + L11*SIN(Q3) + L10*SIN(Q3-Q7) + L8*SIN(Q3-Q6-Q7) + L6*
     &SIN(Q3-Q5-Q6-Q7) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      POGOX = Q1 + GS*COS(Q3) + L10*COS(Q3-Q7) + L8*COS(Q3-Q6-Q7) + L6*C
     &OS(Q3-Q5-Q6-Q7) - L2*COS(Q3-Q4-Q5-Q6-Q7)
      POGOY = Q2 + GS*SIN(Q3) + L10*SIN(Q3-Q7) + L8*SIN(Q3-Q6-Q7) + L6*S
     &IN(Q3-Q5-Q6-Q7) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      POCMX = Q1 - 0.5D0*(2*L12*MF*COS(EA-FA-Q3)+2*(L1*MA+L2*MB+L2*MC+L2
     &*MD+L2*ME+L2*MF+L2*MG)*COS(Q3-Q4-Q5-Q6-Q7)-2*MG*GS*COS(Q3)-L3*MB*C
     &OS(FOOTANG+Q3-Q5-Q6-Q7)-2*(L10*MF+ME*(L10-L9))*COS(EA-Q3)-2*(L10*M
     &E+L10*MF+L10*MG+L9*MD)*COS(Q3-Q7)-2*(L7*MC+L8*MD+L8*ME+L8*MF+L8*MG
     &)*COS(Q3-Q6-Q7)-(L4*MB+2*L6*MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)*CO
     &S(Q3-Q5-Q6-Q7))/(MA+MB+MC+MD+ME+MF+MG)
      POCMSTANCEX = Q1 + 0.5D0*(2*L9*MD*COS(Q3-Q7)+L3*MB*COS(FOOTANG+Q3-
     &Q5-Q6-Q7)+2*(L7*MC+L8*MD)*COS(Q3-Q6-Q7)+(L4*MB+2*L6*MC+2*L6*MD)*CO
     &S(Q3-Q5-Q6-Q7)-2*(L1*MA+L2*MB+L2*MC+L2*MD)*COS(Q3-Q4-Q5-Q6-Q7))/(M
     &A+MB+MC+MD)
      POCMSTANCEY = Q2 + 0.5D0*(2*L9*MD*SIN(Q3-Q7)+L3*MB*SIN(FOOTANG+Q3-
     &Q5-Q6-Q7)+2*(L7*MC+L8*MD)*SIN(Q3-Q6-Q7)+(L4*MB+2*L6*MC+2*L6*MD)*SI
     &N(Q3-Q5-Q6-Q7)-2*(L1*MA+L2*MB+L2*MC+L2*MD)*SIN(Q3-Q4-Q5-Q6-Q7))/(M
     &A+MB+MC+MD)
      POCMSWINGX = Q1 + L10*COS(Q3-Q7) + L8*COS(Q3-Q6-Q7) + L6*COS(Q3-Q5
     &-Q6-Q7) - L2*COS(Q3-Q4-Q5-Q6-Q7) - (L12*MF*COS(EA-FA-Q3)-(L10*MF+M
     &E*(L10-L9))*COS(EA-Q3))/(ME+MF)
      POCMSWINGY = Q2 + L10*SIN(Q3-Q7) + L8*SIN(Q3-Q6-Q7) + L6*SIN(Q3-Q5
     &-Q6-Q7) + (L12*MF*SIN(EA-FA-Q3)-(L10*MF+ME*(L10-L9))*SIN(EA-Q3))/(
     &ME+MF) - L2*SIN(Q3-Q4-Q5-Q6-Q7)
      VOCMX = U1 - 0.5D0*(2*MG*GS*SIN(Q3)*U3+2*(L10*ME+L10*MF+L10*MG+L9*
     &MD)*SIN(Q3-Q7)*(U3-U7)+2*(L10*MF+ME*(L10-L9))*SIN(EA-Q3)*(EAp-U3-U
     &8)+L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)+2*(L7*MC+L8*MD+L8*
     &ME+L8*MF+L8*MG)*SIN(Q3-Q6-Q7)*(U3-U6-U7)+(L4*MB+2*L6*MC+2*L6*MD+2*
     &L6*ME+2*L6*MF+2*L6*MG)*SIN(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)-2*MG*GSp*COS
     &(Q3)-2*L12*MF*SIN(EA-FA-Q3)*(EAp-FAp-U3-U8-U9)-2*(L1*MA+L2*MB+L2*M
     &C+L2*MD+L2*ME+L2*MF+L2*MG)*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7))/(
     &MA+MB+MC+MD+ME+MF+MG)
      VOCMY = U2 + 0.5D0*(2*MG*GSp*SIN(Q3)+2*MG*GS*COS(Q3)*U3+2*(L10*ME+
     &L10*MF+L10*MG+L9*MD)*COS(Q3-Q7)*(U3-U7)+2*L12*MF*COS(EA-FA-Q3)*(EA
     &p-FAp-U3-U8-U9)+L3*MB*COS(FOOTANG+Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)+2*(L7
     &*MC+L8*MD+L8*ME+L8*MF+L8*MG)*COS(Q3-Q6-Q7)*(U3-U6-U7)+(L4*MB+2*L6*
     &MC+2*L6*MD+2*L6*ME+2*L6*MF+2*L6*MG)*COS(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)
     &-2*(L10*MF+ME*(L10-L9))*COS(EA-Q3)*(EAp-U3-U8)-2*(L1*MA+L2*MB+L2*M
     &C+L2*MD+L2*ME+L2*MF+L2*MG)*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7))/(
     &MA+MB+MC+MD+ME+MF+MG)
      VOCMSTANCEX = U1 - 0.5D0*(2*L9*MD*SIN(Q3-Q7)*(U3-U7)+2*(L7*MC+L8*M
     &D)*SIN(Q3-Q6-Q7)*(U3-U6-U7)+L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7)*(U3-U5-
     &U6-U7)+(L4*MB+2*L6*MC+2*L6*MD)*SIN(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)-2*(L
     &1*MA+L2*MB+L2*MC+L2*MD)*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7))/(MA+
     &MB+MC+MD)
      VOCMSTANCEY = U2 + 0.5D0*(2*L9*MD*COS(Q3-Q7)*(U3-U7)+2*(L7*MC+L8*M
     &D)*COS(Q3-Q6-Q7)*(U3-U6-U7)+L3*MB*COS(FOOTANG+Q3-Q5-Q6-Q7)*(U3-U5-
     &U6-U7)+(L4*MB+2*L6*MC+2*L6*MD)*COS(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7)-2*(L
     &1*MA+L2*MB+L2*MC+L2*MD)*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7))/(MA+
     &MB+MC+MD)
      VOCMSWINGX = U1 + L2*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7) - L10*SI
     &N(Q3-Q7)*(U3-U7) - L8*SIN(Q3-Q6-Q7)*(U3-U6-U7) - L6*SIN(Q3-Q5-Q6-Q
     &7)*(U3-U5-U6-U7) - ((L10*MF+ME*(L10-L9))*SIN(EA-Q3)*(EAp-U3-U8)-L1
     &2*MF*SIN(EA-FA-Q3)*(EAp-FAp-U3-U8-U9))/(ME+MF)
      VOCMSWINGY = U2 + L10*COS(Q3-Q7)*(U3-U7) + L8*COS(Q3-Q6-Q7)*(U3-U6
     &-U7) + L6*COS(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7) - L2*COS(Q3-Q4-Q5-Q6-Q7)*
     &(U3-U4-U5-U6-U7) - ((L10*MF+ME*(L10-L9))*COS(EA-Q3)*(EAp-U3-U8)-L1
     &2*MF*COS(EA-FA-Q3)*(EAp-FAp-U3-U8-U9))/(ME+MF)
      PSWINGX = (ME+MF)*U1 + L12*MF*SIN(EA-FA-Q3)*(EAp-FAp-U3-U8-U9) + L
     &2*(ME+MF)*SIN(Q3-Q4-Q5-Q6-Q7)*(U3-U4-U5-U6-U7) - L10*(ME+MF)*SIN(Q
     &3-Q7)*(U3-U7) - L8*(ME+MF)*SIN(Q3-Q6-Q7)*(U3-U6-U7) - (L10*MF+ME*(
     &L10-L9))*SIN(EA-Q3)*(EAp-U3-U8) - L6*(ME+MF)*SIN(Q3-Q5-Q6-Q7)*(U3-
     &U5-U6-U7)
      PSWINGY = (ME+MF)*U2 + L10*(ME+MF)*COS(Q3-Q7)*(U3-U7) + L8*(ME+MF)
     &*COS(Q3-Q6-Q7)*(U3-U6-U7) + L12*MF*COS(EA-FA-Q3)*(EAp-FAp-U3-U8-U9
     &) + L6*(ME+MF)*COS(Q3-Q5-Q6-Q7)*(U3-U5-U6-U7) - (L10*MF+ME*(L10-L9
     &))*COS(EA-Q3)*(EAp-U3-U8) - L2*(ME+MF)*COS(Q3-Q4-Q5-Q6-Q7)*(U3-U4-
     &U5-U6-U7)
      PSTANCEX = (MA+MB+MC+MD)*U1 + (L1*MA+L2*MB+L2*MC+L2*MD)*SIN(Q3-Q4-
     &Q5-Q6-Q7)*(U3-U4-U5-U6-U7) - L9*MD*SIN(Q3-Q7)*(U3-U7) - (L7*MC+L8*
     &MD)*SIN(Q3-Q6-Q7)*(U3-U6-U7) - 0.5D0*L3*MB*SIN(FOOTANG+Q3-Q5-Q6-Q7
     &)*(U3-U5-U6-U7) - 0.5D0*(L4*MB+2*L6*MC+2*L6*MD)*SIN(Q3-Q5-Q6-Q7)*(
     &U3-U5-U6-U7)
      PSTANCEY = (MA+MB+MC+MD)*U2 + L9*MD*COS(Q3-Q7)*(U3-U7) + (L7*MC+L8
     &*MD)*COS(Q3-Q6-Q7)*(U3-U6-U7) + 0.5D0*L3*MB*COS(FOOTANG+Q3-Q5-Q6-Q
     &7)*(U3-U5-U6-U7) + 0.5D0*(L4*MB+2*L6*MC+2*L6*MD)*COS(Q3-Q5-Q6-Q7)*
     &(U3-U5-U6-U7) - (L1*MA+L2*MB+L2*MC+L2*MD)*COS(Q3-Q4-Q5-Q6-Q7)*(U3-
     &U4-U5-U6-U7)

C**   Write output to screen and to output file(s)
      WRITE(*, 6020) T,POP1X,POP1Y,POP2X,POP2Y,POP3X,POP3Y,POP4X,POP4Y,P
     &OP5X,POP5Y,POP6X,POP6Y,POP7X,POP7Y,POP8X,POP8Y,POP9X,POP9Y,POGOX,P
     &OGOY,POCMSTANCEX,POCMSTANCEY,POCMSWINGX,POCMSWINGY,POCMX,POCMY,VOC
     &MX,VOCMY,PSTANCEX,PSTANCEY,PSWINGX,PSWINGY,VOCMSTANCEX,VOCMSTANCEY
     &,VOCMSWINGX,VOCMSWINGY
      WRITE(21,6020) T,POP1X,POP1Y,POP2X,POP2Y,POP3X,POP3Y,POP4X,POP4Y,P
     &OP5X,POP5Y,POP6X,POP6Y,POP7X,POP7Y,POP8X,POP8Y,POP9X,POP9Y,POGOX,P
     &OGOY,POCMSTANCEX,POCMSTANCEY,POCMSWINGX,POCMSWINGY,POCMX,POCMY,VOC
     &MX,VOCMY,PSTANCEX,PSTANCEY,PSWINGX,PSWINGY,VOCMSTANCEX,VOCMSTANCEY
     &,VOCMSWINGX,VOCMSWINGY
      WRITE(22,6020) T,Q1,Q2,(Q3*RADtoDEG),(Q4*RADtoDEG),(Q5*RADtoDEG),(
     &Q6*RADtoDEG),(Q7*RADtoDEG),U1,U2,U3,U4,U5,U6,U7
      WRITE(23,6020) T,RX,RY,HTOR,KTOR,ATOR,MTOR,SHTOR,SKTOR
      WRITE(24,6020) T,(Q3*RADtoDEG),(HANG*RADtoDEG),(KANG*RADtoDEG),(AA
     &NG*RADtoDEG),(MANG*RADtoDEG),(SHANG*RADtoDEG),(SKANG*RADtoDEG),U3,
     &HANGVEL,KANGVEL,AANGVEL,MANGVEL,SHANGVEL,SKANGVEL
      WRITE(25,6020) T,KECM,PECM,TE,HZ,PX,PY
      WRITE(26,6020) T,HEACT,HFACT,KEACT,KFACT,AEACT,AFACT,MEACT,MFACT
      WRITE(27,6020) T,HETOR,HEACT,(HECCANG*RADtoDEG),HECCANGVEL,(HESECA
     &NG*RADtoDEG),HESECANGVEL,HFTOR,HFACT,(HFCCANG*RADtoDEG),HFCCANGVEL
     &,(HFSECANG*RADtoDEG),HFSECANGVEL
      WRITE(28,6020) T,KETOR,KEACT,(KECCANG*RADtoDEG),KECCANGVEL,(KESECA
     &NG*RADtoDEG),KESECANGVEL,KFTOR,KFACT,(KFCCANG*RADtoDEG),KFCCANGVEL
     &,(KFSECANG*RADtoDEG),KFSECANGVEL
      WRITE(29,6020) T,AETOR,AEACT,(AECCANG*RADtoDEG),AECCANGVEL,(AESECA
     &NG*RADtoDEG),AESECANGVEL,AFTOR,AFACT,(AFCCANG*RADtoDEG),AFCCANGVEL
     &,(AFSECANG*RADtoDEG),AFSECANGVEL
      WRITE(30,6020) T,METOR,MEACT,(MECCANG*RADtoDEG),MECCANGVEL,(MESECA
     &NG*RADtoDEG),MESECANGVEL,MFTOR,MFACT,(MFCCANG*RADtoDEG),MFCCANGVEL
     &,(MFSECANG*RADtoDEG),MFSECANGVEL
      WRITE(31,6020) T,RX1,RY1,RX2,RY2,RX,RY,GRF,COP

6020  FORMAT( 99(1X, 1PE14.6E3) )

      RETURN
      END


